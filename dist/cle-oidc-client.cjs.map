{"version":3,"file":"cle-oidc-client.cjs","sources":["../__vite-browser-external","../node_modules/crypto-js/core.js","../node_modules/crypto-js/sha256.js","../node_modules/crypto-js/enc-base64.js","../node_modules/crypto-js/enc-utf8.js","../node_modules/jwt-decode/build/jwt-decode.esm.js","../node_modules/oidc-client-ts/dist/esm/oidc-client-ts.js","../src/utils.ts","../src/auth.ts"],"sourcesContent":["export default {}",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory();\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\troot.CryptoJS = factory();\n\t}\n}(this, function () {\n\n\t/*globals window, global, require*/\n\n\t/**\n\t * CryptoJS core components.\n\t */\n\tvar CryptoJS = CryptoJS || (function (Math, undefined) {\n\n\t    var crypto;\n\n\t    // Native crypto from window (Browser)\n\t    if (typeof window !== 'undefined' && window.crypto) {\n\t        crypto = window.crypto;\n\t    }\n\n\t    // Native crypto in web worker (Browser)\n\t    if (typeof self !== 'undefined' && self.crypto) {\n\t        crypto = self.crypto;\n\t    }\n\n\t    // Native crypto from worker\n\t    if (typeof globalThis !== 'undefined' && globalThis.crypto) {\n\t        crypto = globalThis.crypto;\n\t    }\n\n\t    // Native (experimental IE 11) crypto from window (Browser)\n\t    if (!crypto && typeof window !== 'undefined' && window.msCrypto) {\n\t        crypto = window.msCrypto;\n\t    }\n\n\t    // Native crypto from global (NodeJS)\n\t    if (!crypto && typeof global !== 'undefined' && global.crypto) {\n\t        crypto = global.crypto;\n\t    }\n\n\t    // Native crypto import via require (NodeJS)\n\t    if (!crypto && typeof require === 'function') {\n\t        try {\n\t            crypto = require('crypto');\n\t        } catch (err) {}\n\t    }\n\n\t    /*\n\t     * Cryptographically secure pseudorandom number generator\n\t     *\n\t     * As Math.random() is cryptographically not safe to use\n\t     */\n\t    var cryptoSecureRandomInt = function () {\n\t        if (crypto) {\n\t            // Use getRandomValues method (Browser)\n\t            if (typeof crypto.getRandomValues === 'function') {\n\t                try {\n\t                    return crypto.getRandomValues(new Uint32Array(1))[0];\n\t                } catch (err) {}\n\t            }\n\n\t            // Use randomBytes method (NodeJS)\n\t            if (typeof crypto.randomBytes === 'function') {\n\t                try {\n\t                    return crypto.randomBytes(4).readInt32LE();\n\t                } catch (err) {}\n\t            }\n\t        }\n\n\t        throw new Error('Native crypto module could not be used to get secure random number.');\n\t    };\n\n\t    /*\n\t     * Local polyfill of Object.create\n\n\t     */\n\t    var create = Object.create || (function () {\n\t        function F() {}\n\n\t        return function (obj) {\n\t            var subtype;\n\n\t            F.prototype = obj;\n\n\t            subtype = new F();\n\n\t            F.prototype = null;\n\n\t            return subtype;\n\t        };\n\t    }());\n\n\t    /**\n\t     * CryptoJS namespace.\n\t     */\n\t    var C = {};\n\n\t    /**\n\t     * Library namespace.\n\t     */\n\t    var C_lib = C.lib = {};\n\n\t    /**\n\t     * Base object for prototypal inheritance.\n\t     */\n\t    var Base = C_lib.Base = (function () {\n\n\n\t        return {\n\t            /**\n\t             * Creates a new object that inherits from this object.\n\t             *\n\t             * @param {Object} overrides Properties to copy into the new object.\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         field: 'value',\n\t             *\n\t             *         method: function () {\n\t             *         }\n\t             *     });\n\t             */\n\t            extend: function (overrides) {\n\t                // Spawn\n\t                var subtype = create(this);\n\n\t                // Augment\n\t                if (overrides) {\n\t                    subtype.mixIn(overrides);\n\t                }\n\n\t                // Create default initializer\n\t                if (!subtype.hasOwnProperty('init') || this.init === subtype.init) {\n\t                    subtype.init = function () {\n\t                        subtype.$super.init.apply(this, arguments);\n\t                    };\n\t                }\n\n\t                // Initializer's prototype is the subtype object\n\t                subtype.init.prototype = subtype;\n\n\t                // Reference supertype\n\t                subtype.$super = this;\n\n\t                return subtype;\n\t            },\n\n\t            /**\n\t             * Extends this object and runs the init method.\n\t             * Arguments to create() will be passed to init().\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var instance = MyType.create();\n\t             */\n\t            create: function () {\n\t                var instance = this.extend();\n\t                instance.init.apply(instance, arguments);\n\n\t                return instance;\n\t            },\n\n\t            /**\n\t             * Initializes a newly created object.\n\t             * Override this method to add some logic when your objects are created.\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         init: function () {\n\t             *             // ...\n\t             *         }\n\t             *     });\n\t             */\n\t            init: function () {\n\t            },\n\n\t            /**\n\t             * Copies properties into this object.\n\t             *\n\t             * @param {Object} properties The properties to mix in.\n\t             *\n\t             * @example\n\t             *\n\t             *     MyType.mixIn({\n\t             *         field: 'value'\n\t             *     });\n\t             */\n\t            mixIn: function (properties) {\n\t                for (var propertyName in properties) {\n\t                    if (properties.hasOwnProperty(propertyName)) {\n\t                        this[propertyName] = properties[propertyName];\n\t                    }\n\t                }\n\n\t                // IE won't copy toString using the loop above\n\t                if (properties.hasOwnProperty('toString')) {\n\t                    this.toString = properties.toString;\n\t                }\n\t            },\n\n\t            /**\n\t             * Creates a copy of this object.\n\t             *\n\t             * @return {Object} The clone.\n\t             *\n\t             * @example\n\t             *\n\t             *     var clone = instance.clone();\n\t             */\n\t            clone: function () {\n\t                return this.init.prototype.extend(this);\n\t            }\n\t        };\n\t    }());\n\n\t    /**\n\t     * An array of 32-bit words.\n\t     *\n\t     * @property {Array} words The array of 32-bit words.\n\t     * @property {number} sigBytes The number of significant bytes in this word array.\n\t     */\n\t    var WordArray = C_lib.WordArray = Base.extend({\n\t        /**\n\t         * Initializes a newly created word array.\n\t         *\n\t         * @param {Array} words (Optional) An array of 32-bit words.\n\t         * @param {number} sigBytes (Optional) The number of significant bytes in the words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.create();\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607]);\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607], 6);\n\t         */\n\t        init: function (words, sigBytes) {\n\t            words = this.words = words || [];\n\n\t            if (sigBytes != undefined) {\n\t                this.sigBytes = sigBytes;\n\t            } else {\n\t                this.sigBytes = words.length * 4;\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts this word array to a string.\n\t         *\n\t         * @param {Encoder} encoder (Optional) The encoding strategy to use. Default: CryptoJS.enc.Hex\n\t         *\n\t         * @return {string} The stringified word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     var string = wordArray + '';\n\t         *     var string = wordArray.toString();\n\t         *     var string = wordArray.toString(CryptoJS.enc.Utf8);\n\t         */\n\t        toString: function (encoder) {\n\t            return (encoder || Hex).stringify(this);\n\t        },\n\n\t        /**\n\t         * Concatenates a word array to this word array.\n\t         *\n\t         * @param {WordArray} wordArray The word array to append.\n\t         *\n\t         * @return {WordArray} This word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray1.concat(wordArray2);\n\t         */\n\t        concat: function (wordArray) {\n\t            // Shortcuts\n\t            var thisWords = this.words;\n\t            var thatWords = wordArray.words;\n\t            var thisSigBytes = this.sigBytes;\n\t            var thatSigBytes = wordArray.sigBytes;\n\n\t            // Clamp excess bits\n\t            this.clamp();\n\n\t            // Concat\n\t            if (thisSigBytes % 4) {\n\t                // Copy one byte at a time\n\t                for (var i = 0; i < thatSigBytes; i++) {\n\t                    var thatByte = (thatWords[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                    thisWords[(thisSigBytes + i) >>> 2] |= thatByte << (24 - ((thisSigBytes + i) % 4) * 8);\n\t                }\n\t            } else {\n\t                // Copy one word at a time\n\t                for (var j = 0; j < thatSigBytes; j += 4) {\n\t                    thisWords[(thisSigBytes + j) >>> 2] = thatWords[j >>> 2];\n\t                }\n\t            }\n\t            this.sigBytes += thatSigBytes;\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Removes insignificant bits.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray.clamp();\n\t         */\n\t        clamp: function () {\n\t            // Shortcuts\n\t            var words = this.words;\n\t            var sigBytes = this.sigBytes;\n\n\t            // Clamp\n\t            words[sigBytes >>> 2] &= 0xffffffff << (32 - (sigBytes % 4) * 8);\n\t            words.length = Math.ceil(sigBytes / 4);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this word array.\n\t         *\n\t         * @return {WordArray} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = wordArray.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone.words = this.words.slice(0);\n\n\t            return clone;\n\t        },\n\n\t        /**\n\t         * Creates a word array filled with random bytes.\n\t         *\n\t         * @param {number} nBytes The number of random bytes to generate.\n\t         *\n\t         * @return {WordArray} The random word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.random(16);\n\t         */\n\t        random: function (nBytes) {\n\t            var words = [];\n\n\t            for (var i = 0; i < nBytes; i += 4) {\n\t                words.push(cryptoSecureRandomInt());\n\t            }\n\n\t            return new WordArray.init(words, nBytes);\n\t        }\n\t    });\n\n\t    /**\n\t     * Encoder namespace.\n\t     */\n\t    var C_enc = C.enc = {};\n\n\t    /**\n\t     * Hex encoding strategy.\n\t     */\n\t    var Hex = C_enc.Hex = {\n\t        /**\n\t         * Converts a word array to a hex string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The hex string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var hexString = CryptoJS.enc.Hex.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var hexChars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                hexChars.push((bite >>> 4).toString(16));\n\t                hexChars.push((bite & 0x0f).toString(16));\n\t            }\n\n\t            return hexChars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a hex string to a word array.\n\t         *\n\t         * @param {string} hexStr The hex string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Hex.parse(hexString);\n\t         */\n\t        parse: function (hexStr) {\n\t            // Shortcut\n\t            var hexStrLength = hexStr.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < hexStrLength; i += 2) {\n\t                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << (24 - (i % 8) * 4);\n\t            }\n\n\t            return new WordArray.init(words, hexStrLength / 2);\n\t        }\n\t    };\n\n\t    /**\n\t     * Latin1 encoding strategy.\n\t     */\n\t    var Latin1 = C_enc.Latin1 = {\n\t        /**\n\t         * Converts a word array to a Latin1 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The Latin1 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var latin1String = CryptoJS.enc.Latin1.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var latin1Chars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                latin1Chars.push(String.fromCharCode(bite));\n\t            }\n\n\t            return latin1Chars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a Latin1 string to a word array.\n\t         *\n\t         * @param {string} latin1Str The Latin1 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Latin1.parse(latin1String);\n\t         */\n\t        parse: function (latin1Str) {\n\t            // Shortcut\n\t            var latin1StrLength = latin1Str.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < latin1StrLength; i++) {\n\t                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 0xff) << (24 - (i % 4) * 8);\n\t            }\n\n\t            return new WordArray.init(words, latin1StrLength);\n\t        }\n\t    };\n\n\t    /**\n\t     * UTF-8 encoding strategy.\n\t     */\n\t    var Utf8 = C_enc.Utf8 = {\n\t        /**\n\t         * Converts a word array to a UTF-8 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The UTF-8 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            try {\n\t                return decodeURIComponent(escape(Latin1.stringify(wordArray)));\n\t            } catch (e) {\n\t                throw new Error('Malformed UTF-8 data');\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts a UTF-8 string to a word array.\n\t         *\n\t         * @param {string} utf8Str The UTF-8 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Utf8.parse(utf8String);\n\t         */\n\t        parse: function (utf8Str) {\n\t            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));\n\t        }\n\t    };\n\n\t    /**\n\t     * Abstract buffered block algorithm template.\n\t     *\n\t     * The property blockSize must be implemented in a concrete subtype.\n\t     *\n\t     * @property {number} _minBufferSize The number of blocks that should be kept unprocessed in the buffer. Default: 0\n\t     */\n\t    var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({\n\t        /**\n\t         * Resets this block algorithm's data buffer to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm.reset();\n\t         */\n\t        reset: function () {\n\t            // Initial values\n\t            this._data = new WordArray.init();\n\t            this._nDataBytes = 0;\n\t        },\n\n\t        /**\n\t         * Adds new data to this block algorithm's buffer.\n\t         *\n\t         * @param {WordArray|string} data The data to append. Strings are converted to a WordArray using UTF-8.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm._append('data');\n\t         *     bufferedBlockAlgorithm._append(wordArray);\n\t         */\n\t        _append: function (data) {\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof data == 'string') {\n\t                data = Utf8.parse(data);\n\t            }\n\n\t            // Append\n\t            this._data.concat(data);\n\t            this._nDataBytes += data.sigBytes;\n\t        },\n\n\t        /**\n\t         * Processes available data blocks.\n\t         *\n\t         * This method invokes _doProcessBlock(offset), which must be implemented by a concrete subtype.\n\t         *\n\t         * @param {boolean} doFlush Whether all blocks and partial blocks should be processed.\n\t         *\n\t         * @return {WordArray} The processed data.\n\t         *\n\t         * @example\n\t         *\n\t         *     var processedData = bufferedBlockAlgorithm._process();\n\t         *     var processedData = bufferedBlockAlgorithm._process(!!'flush');\n\t         */\n\t        _process: function (doFlush) {\n\t            var processedWords;\n\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\t            var dataSigBytes = data.sigBytes;\n\t            var blockSize = this.blockSize;\n\t            var blockSizeBytes = blockSize * 4;\n\n\t            // Count blocks ready\n\t            var nBlocksReady = dataSigBytes / blockSizeBytes;\n\t            if (doFlush) {\n\t                // Round up to include partial blocks\n\t                nBlocksReady = Math.ceil(nBlocksReady);\n\t            } else {\n\t                // Round down to include only full blocks,\n\t                // less the number of blocks that must remain in the buffer\n\t                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);\n\t            }\n\n\t            // Count words ready\n\t            var nWordsReady = nBlocksReady * blockSize;\n\n\t            // Count bytes ready\n\t            var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);\n\n\t            // Process blocks\n\t            if (nWordsReady) {\n\t                for (var offset = 0; offset < nWordsReady; offset += blockSize) {\n\t                    // Perform concrete-algorithm logic\n\t                    this._doProcessBlock(dataWords, offset);\n\t                }\n\n\t                // Remove processed words\n\t                processedWords = dataWords.splice(0, nWordsReady);\n\t                data.sigBytes -= nBytesReady;\n\t            }\n\n\t            // Return processed words\n\t            return new WordArray.init(processedWords, nBytesReady);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this object.\n\t         *\n\t         * @return {Object} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = bufferedBlockAlgorithm.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone._data = this._data.clone();\n\n\t            return clone;\n\t        },\n\n\t        _minBufferSize: 0\n\t    });\n\n\t    /**\n\t     * Abstract hasher template.\n\t     *\n\t     * @property {number} blockSize The number of 32-bit words this hasher operates on. Default: 16 (512 bits)\n\t     */\n\t    var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({\n\t        /**\n\t         * Configuration options.\n\t         */\n\t        cfg: Base.extend(),\n\n\t        /**\n\t         * Initializes a newly created hasher.\n\t         *\n\t         * @param {Object} cfg (Optional) The configuration options to use for this hash computation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hasher = CryptoJS.algo.SHA256.create();\n\t         */\n\t        init: function (cfg) {\n\t            // Apply config defaults\n\t            this.cfg = this.cfg.extend(cfg);\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this hasher to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Reset data buffer\n\t            BufferedBlockAlgorithm.reset.call(this);\n\n\t            // Perform concrete-hasher logic\n\t            this._doReset();\n\t        },\n\n\t        /**\n\t         * Updates this hasher with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {Hasher} This hasher.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.update('message');\n\t         *     hasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            // Append\n\t            this._append(messageUpdate);\n\n\t            // Update the hash\n\t            this._process();\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the hash computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The hash.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hash = hasher.finalize();\n\t         *     var hash = hasher.finalize('message');\n\t         *     var hash = hasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Final message update\n\t            if (messageUpdate) {\n\t                this._append(messageUpdate);\n\t            }\n\n\t            // Perform concrete-hasher logic\n\t            var hash = this._doFinalize();\n\n\t            return hash;\n\t        },\n\n\t        blockSize: 512/32,\n\n\t        /**\n\t         * Creates a shortcut function to a hasher's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to create a helper for.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var SHA256 = CryptoJS.lib.Hasher._createHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHelper: function (hasher) {\n\t            return function (message, cfg) {\n\t                return new hasher.init(cfg).finalize(message);\n\t            };\n\t        },\n\n\t        /**\n\t         * Creates a shortcut function to the HMAC's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to use in this HMAC helper.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var HmacSHA256 = CryptoJS.lib.Hasher._createHmacHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHmacHelper: function (hasher) {\n\t            return function (message, key) {\n\t                return new C_algo.HMAC.init(hasher, key).finalize(message);\n\t            };\n\t        }\n\t    });\n\n\t    /**\n\t     * Algorithm namespace.\n\t     */\n\t    var C_algo = C.algo = {};\n\n\t    return C;\n\t}(Math));\n\n\n\treturn CryptoJS;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function (Math) {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\t    var Hasher = C_lib.Hasher;\n\t    var C_algo = C.algo;\n\n\t    // Initialization and round constants tables\n\t    var H = [];\n\t    var K = [];\n\n\t    // Compute constants\n\t    (function () {\n\t        function isPrime(n) {\n\t            var sqrtN = Math.sqrt(n);\n\t            for (var factor = 2; factor <= sqrtN; factor++) {\n\t                if (!(n % factor)) {\n\t                    return false;\n\t                }\n\t            }\n\n\t            return true;\n\t        }\n\n\t        function getFractionalBits(n) {\n\t            return ((n - (n | 0)) * 0x100000000) | 0;\n\t        }\n\n\t        var n = 2;\n\t        var nPrime = 0;\n\t        while (nPrime < 64) {\n\t            if (isPrime(n)) {\n\t                if (nPrime < 8) {\n\t                    H[nPrime] = getFractionalBits(Math.pow(n, 1 / 2));\n\t                }\n\t                K[nPrime] = getFractionalBits(Math.pow(n, 1 / 3));\n\n\t                nPrime++;\n\t            }\n\n\t            n++;\n\t        }\n\t    }());\n\n\t    // Reusable object\n\t    var W = [];\n\n\t    /**\n\t     * SHA-256 hash algorithm.\n\t     */\n\t    var SHA256 = C_algo.SHA256 = Hasher.extend({\n\t        _doReset: function () {\n\t            this._hash = new WordArray.init(H.slice(0));\n\t        },\n\n\t        _doProcessBlock: function (M, offset) {\n\t            // Shortcut\n\t            var H = this._hash.words;\n\n\t            // Working variables\n\t            var a = H[0];\n\t            var b = H[1];\n\t            var c = H[2];\n\t            var d = H[3];\n\t            var e = H[4];\n\t            var f = H[5];\n\t            var g = H[6];\n\t            var h = H[7];\n\n\t            // Computation\n\t            for (var i = 0; i < 64; i++) {\n\t                if (i < 16) {\n\t                    W[i] = M[offset + i] | 0;\n\t                } else {\n\t                    var gamma0x = W[i - 15];\n\t                    var gamma0  = ((gamma0x << 25) | (gamma0x >>> 7))  ^\n\t                                  ((gamma0x << 14) | (gamma0x >>> 18)) ^\n\t                                   (gamma0x >>> 3);\n\n\t                    var gamma1x = W[i - 2];\n\t                    var gamma1  = ((gamma1x << 15) | (gamma1x >>> 17)) ^\n\t                                  ((gamma1x << 13) | (gamma1x >>> 19)) ^\n\t                                   (gamma1x >>> 10);\n\n\t                    W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16];\n\t                }\n\n\t                var ch  = (e & f) ^ (~e & g);\n\t                var maj = (a & b) ^ (a & c) ^ (b & c);\n\n\t                var sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));\n\t                var sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7)  | (e >>> 25));\n\n\t                var t1 = h + sigma1 + ch + K[i] + W[i];\n\t                var t2 = sigma0 + maj;\n\n\t                h = g;\n\t                g = f;\n\t                f = e;\n\t                e = (d + t1) | 0;\n\t                d = c;\n\t                c = b;\n\t                b = a;\n\t                a = (t1 + t2) | 0;\n\t            }\n\n\t            // Intermediate hash value\n\t            H[0] = (H[0] + a) | 0;\n\t            H[1] = (H[1] + b) | 0;\n\t            H[2] = (H[2] + c) | 0;\n\t            H[3] = (H[3] + d) | 0;\n\t            H[4] = (H[4] + e) | 0;\n\t            H[5] = (H[5] + f) | 0;\n\t            H[6] = (H[6] + g) | 0;\n\t            H[7] = (H[7] + h) | 0;\n\t        },\n\n\t        _doFinalize: function () {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\n\t            var nBitsTotal = this._nDataBytes * 8;\n\t            var nBitsLeft = data.sigBytes * 8;\n\n\t            // Add padding\n\t            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = Math.floor(nBitsTotal / 0x100000000);\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotal;\n\t            data.sigBytes = dataWords.length * 4;\n\n\t            // Hash final blocks\n\t            this._process();\n\n\t            // Return final computed hash\n\t            return this._hash;\n\t        },\n\n\t        clone: function () {\n\t            var clone = Hasher.clone.call(this);\n\t            clone._hash = this._hash.clone();\n\n\t            return clone;\n\t        }\n\t    });\n\n\t    /**\n\t     * Shortcut function to the hasher's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     *\n\t     * @return {WordArray} The hash.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hash = CryptoJS.SHA256('message');\n\t     *     var hash = CryptoJS.SHA256(wordArray);\n\t     */\n\t    C.SHA256 = Hasher._createHelper(SHA256);\n\n\t    /**\n\t     * Shortcut function to the HMAC's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     * @param {WordArray|string} key The secret key.\n\t     *\n\t     * @return {WordArray} The HMAC.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hmac = CryptoJS.HmacSHA256(message, key);\n\t     */\n\t    C.HmacSHA256 = Hasher._createHmacHelper(SHA256);\n\t}(Math));\n\n\n\treturn CryptoJS.SHA256;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\t    var C_enc = C.enc;\n\n\t    /**\n\t     * Base64 encoding strategy.\n\t     */\n\t    var Base64 = C_enc.Base64 = {\n\t        /**\n\t         * Converts a word array to a Base64 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The Base64 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var base64String = CryptoJS.enc.Base64.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\t            var map = this._map;\n\n\t            // Clamp excess bits\n\t            wordArray.clamp();\n\n\t            // Convert\n\t            var base64Chars = [];\n\t            for (var i = 0; i < sigBytes; i += 3) {\n\t                var byte1 = (words[i >>> 2]       >>> (24 - (i % 4) * 8))       & 0xff;\n\t                var byte2 = (words[(i + 1) >>> 2] >>> (24 - ((i + 1) % 4) * 8)) & 0xff;\n\t                var byte3 = (words[(i + 2) >>> 2] >>> (24 - ((i + 2) % 4) * 8)) & 0xff;\n\n\t                var triplet = (byte1 << 16) | (byte2 << 8) | byte3;\n\n\t                for (var j = 0; (j < 4) && (i + j * 0.75 < sigBytes); j++) {\n\t                    base64Chars.push(map.charAt((triplet >>> (6 * (3 - j))) & 0x3f));\n\t                }\n\t            }\n\n\t            // Add padding\n\t            var paddingChar = map.charAt(64);\n\t            if (paddingChar) {\n\t                while (base64Chars.length % 4) {\n\t                    base64Chars.push(paddingChar);\n\t                }\n\t            }\n\n\t            return base64Chars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a Base64 string to a word array.\n\t         *\n\t         * @param {string} base64Str The Base64 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Base64.parse(base64String);\n\t         */\n\t        parse: function (base64Str) {\n\t            // Shortcuts\n\t            var base64StrLength = base64Str.length;\n\t            var map = this._map;\n\t            var reverseMap = this._reverseMap;\n\n\t            if (!reverseMap) {\n\t                    reverseMap = this._reverseMap = [];\n\t                    for (var j = 0; j < map.length; j++) {\n\t                        reverseMap[map.charCodeAt(j)] = j;\n\t                    }\n\t            }\n\n\t            // Ignore padding\n\t            var paddingChar = map.charAt(64);\n\t            if (paddingChar) {\n\t                var paddingIndex = base64Str.indexOf(paddingChar);\n\t                if (paddingIndex !== -1) {\n\t                    base64StrLength = paddingIndex;\n\t                }\n\t            }\n\n\t            // Convert\n\t            return parseLoop(base64Str, base64StrLength, reverseMap);\n\n\t        },\n\n\t        _map: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\n\t    };\n\n\t    function parseLoop(base64Str, base64StrLength, reverseMap) {\n\t      var words = [];\n\t      var nBytes = 0;\n\t      for (var i = 0; i < base64StrLength; i++) {\n\t          if (i % 4) {\n\t              var bits1 = reverseMap[base64Str.charCodeAt(i - 1)] << ((i % 4) * 2);\n\t              var bits2 = reverseMap[base64Str.charCodeAt(i)] >>> (6 - (i % 4) * 2);\n\t              var bitsCombined = bits1 | bits2;\n\t              words[nBytes >>> 2] |= bitsCombined << (24 - (nBytes % 4) * 8);\n\t              nBytes++;\n\t          }\n\t      }\n\t      return WordArray.create(words, nBytes);\n\t    }\n\t}());\n\n\n\treturn CryptoJS.enc.Base64;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\treturn CryptoJS.enc.Utf8;\n\n}));","function e(e){this.message=e}e.prototype=new Error,e.prototype.name=\"InvalidCharacterError\";var r=\"undefined\"!=typeof window&&window.atob&&window.atob.bind(window)||function(r){var t=String(r).replace(/=+$/,\"\");if(t.length%4==1)throw new e(\"'atob' failed: The string to be decoded is not correctly encoded.\");for(var n,o,a=0,i=0,c=\"\";o=t.charAt(i++);~o&&(n=a%4?64*n+o:o,a++%4)?c+=String.fromCharCode(255&n>>(-2*a&6)):0)o=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(o);return c};function t(e){var t=e.replace(/-/g,\"+\").replace(/_/g,\"/\");switch(t.length%4){case 0:break;case 2:t+=\"==\";break;case 3:t+=\"=\";break;default:throw\"Illegal base64url string!\"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,r){var t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t=\"0\"+t),\"%\"+t})))}(t)}catch(e){return r(t)}}function n(e){this.message=e}function o(e,r){if(\"string\"!=typeof e)throw new n(\"Invalid token specified\");var o=!0===(r=r||{}).header?0:1;try{return JSON.parse(t(e.split(\".\")[o]))}catch(e){throw new n(\"Invalid token specified: \"+e.message)}}n.prototype=new Error,n.prototype.name=\"InvalidTokenError\";export default o;export{n as InvalidTokenError};\n//# sourceMappingURL=jwt-decode.esm.js.map\n","// src/utils/CryptoUtils.ts\nimport CryptoJS from \"crypto-js/core.js\";\nimport sha256 from \"crypto-js/sha256.js\";\nimport Base64 from \"crypto-js/enc-base64.js\";\nimport Utf8 from \"crypto-js/enc-utf8.js\";\n\n// src/utils/Logger.ts\nvar nopLogger = {\n  debug: () => void 0,\n  info: () => void 0,\n  warn: () => void 0,\n  error: () => void 0\n};\nvar level;\nvar logger;\nvar Log = /* @__PURE__ */ ((Log2) => {\n  Log2[Log2[\"NONE\"] = 0] = \"NONE\";\n  Log2[Log2[\"ERROR\"] = 1] = \"ERROR\";\n  Log2[Log2[\"WARN\"] = 2] = \"WARN\";\n  Log2[Log2[\"INFO\"] = 3] = \"INFO\";\n  Log2[Log2[\"DEBUG\"] = 4] = \"DEBUG\";\n  return Log2;\n})(Log || {});\n((Log2) => {\n  function reset() {\n    level = 3 /* INFO */;\n    logger = nopLogger;\n  }\n  Log2.reset = reset;\n  function setLevel(value) {\n    if (!(0 /* NONE */ <= value && value <= 4 /* DEBUG */)) {\n      throw new Error(\"Invalid log level\");\n    }\n    level = value;\n  }\n  Log2.setLevel = setLevel;\n  function setLogger(value) {\n    logger = value;\n  }\n  Log2.setLogger = setLogger;\n})(Log || (Log = {}));\nvar Logger = class {\n  constructor(_name) {\n    this._name = _name;\n  }\n  debug(...args) {\n    if (level >= 4 /* DEBUG */) {\n      logger.debug(Logger._format(this._name, this._method), ...args);\n    }\n  }\n  info(...args) {\n    if (level >= 3 /* INFO */) {\n      logger.info(Logger._format(this._name, this._method), ...args);\n    }\n  }\n  warn(...args) {\n    if (level >= 2 /* WARN */) {\n      logger.warn(Logger._format(this._name, this._method), ...args);\n    }\n  }\n  error(...args) {\n    if (level >= 1 /* ERROR */) {\n      logger.error(Logger._format(this._name, this._method), ...args);\n    }\n  }\n  throw(err) {\n    this.error(err);\n    throw err;\n  }\n  create(method) {\n    const methodLogger = Object.create(this);\n    methodLogger._method = method;\n    methodLogger.debug(\"begin\");\n    return methodLogger;\n  }\n  static createStatic(name, staticMethod) {\n    const staticLogger = new Logger(`${name}.${staticMethod}`);\n    staticLogger.debug(\"begin\");\n    return staticLogger;\n  }\n  static _format(name, method) {\n    const prefix = `[${name}]`;\n    return method ? `${prefix} ${method}:` : prefix;\n  }\n  static debug(name, ...args) {\n    if (level >= 4 /* DEBUG */) {\n      logger.debug(Logger._format(name), ...args);\n    }\n  }\n  static info(name, ...args) {\n    if (level >= 3 /* INFO */) {\n      logger.info(Logger._format(name), ...args);\n    }\n  }\n  static warn(name, ...args) {\n    if (level >= 2 /* WARN */) {\n      logger.warn(Logger._format(name), ...args);\n    }\n  }\n  static error(name, ...args) {\n    if (level >= 1 /* ERROR */) {\n      logger.error(Logger._format(name), ...args);\n    }\n  }\n};\nLog.reset();\n\n// src/utils/CryptoUtils.ts\nvar UUID_V4_TEMPLATE = \"10000000-1000-4000-8000-100000000000\";\nvar CryptoUtils = class {\n  static _randomWord() {\n    return CryptoJS.lib.WordArray.random(1).words[0];\n  }\n  static generateUUIDv4() {\n    const uuid = UUID_V4_TEMPLATE.replace(\n      /[018]/g,\n      (c) => (+c ^ CryptoUtils._randomWord() & 15 >> +c / 4).toString(16)\n    );\n    return uuid.replace(/-/g, \"\");\n  }\n  static generateCodeVerifier() {\n    return CryptoUtils.generateUUIDv4() + CryptoUtils.generateUUIDv4() + CryptoUtils.generateUUIDv4();\n  }\n  static generateCodeChallenge(code_verifier) {\n    try {\n      const hashed = sha256(code_verifier);\n      return Base64.stringify(hashed).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n    } catch (err) {\n      Logger.error(\"CryptoUtils.generateCodeChallenge\", err);\n      throw err;\n    }\n  }\n  static generateBasicAuth(client_id, client_secret) {\n    const basicAuth = Utf8.parse([client_id, client_secret].join(\":\"));\n    return Base64.stringify(basicAuth);\n  }\n};\n\n// src/utils/Event.ts\nvar Event = class {\n  constructor(_name) {\n    this._name = _name;\n    this._logger = new Logger(`Event('${this._name}')`);\n    this._callbacks = [];\n  }\n  addHandler(cb) {\n    this._callbacks.push(cb);\n    return () => this.removeHandler(cb);\n  }\n  removeHandler(cb) {\n    const idx = this._callbacks.lastIndexOf(cb);\n    if (idx >= 0) {\n      this._callbacks.splice(idx, 1);\n    }\n  }\n  raise(...ev) {\n    this._logger.debug(\"raise:\", ...ev);\n    for (const cb of this._callbacks) {\n      void cb(...ev);\n    }\n  }\n};\n\n// src/utils/JwtUtils.ts\nimport jwt_decode from \"jwt-decode\";\nvar JwtUtils = class {\n  static decode(token) {\n    try {\n      return jwt_decode(token);\n    } catch (err) {\n      Logger.error(\"JwtUtils.decode\", err);\n      throw err;\n    }\n  }\n};\n\n// src/utils/PopupUtils.ts\nvar PopupUtils = class {\n  static center({ ...features }) {\n    var _a, _b, _c;\n    if (features.width == null)\n      features.width = (_a = [800, 720, 600, 480].find((width) => width <= window.outerWidth / 1.618)) != null ? _a : 360;\n    (_b = features.left) != null ? _b : features.left = Math.max(0, Math.round(window.screenX + (window.outerWidth - features.width) / 2));\n    if (features.height != null)\n      (_c = features.top) != null ? _c : features.top = Math.max(0, Math.round(window.screenY + (window.outerHeight - features.height) / 2));\n    return features;\n  }\n  static serialize(features) {\n    return Object.entries(features).filter(([, value]) => value != null).map(([key, value]) => `${key}=${typeof value !== \"boolean\" ? value : value ? \"yes\" : \"no\"}`).join(\",\");\n  }\n};\n\n// src/utils/Timer.ts\nvar Timer = class extends Event {\n  constructor() {\n    super(...arguments);\n    this._logger = new Logger(`Timer('${this._name}')`);\n    this._timerHandle = null;\n    this._expiration = 0;\n    this._callback = () => {\n      const diff = this._expiration - Timer.getEpochTime();\n      this._logger.debug(\"timer completes in\", diff);\n      if (this._expiration <= Timer.getEpochTime()) {\n        this.cancel();\n        super.raise();\n      }\n    };\n  }\n  static getEpochTime() {\n    return Math.floor(Date.now() / 1e3);\n  }\n  init(durationInSeconds) {\n    const logger2 = this._logger.create(\"init\");\n    durationInSeconds = Math.max(Math.floor(durationInSeconds), 1);\n    const expiration = Timer.getEpochTime() + durationInSeconds;\n    if (this.expiration === expiration && this._timerHandle) {\n      logger2.debug(\"skipping since already initialized for expiration at\", this.expiration);\n      return;\n    }\n    this.cancel();\n    logger2.debug(\"using duration\", durationInSeconds);\n    this._expiration = expiration;\n    const timerDurationInSeconds = Math.min(durationInSeconds, 5);\n    this._timerHandle = setInterval(this._callback, timerDurationInSeconds * 1e3);\n  }\n  get expiration() {\n    return this._expiration;\n  }\n  cancel() {\n    this._logger.create(\"cancel\");\n    if (this._timerHandle) {\n      clearInterval(this._timerHandle);\n      this._timerHandle = null;\n    }\n  }\n};\n\n// src/utils/UrlUtils.ts\nvar UrlUtils = class {\n  static readParams(url, responseMode = \"query\") {\n    if (!url)\n      throw new TypeError(\"Invalid URL\");\n    const parsedUrl = new URL(url, window.location.origin);\n    const params = parsedUrl[responseMode === \"fragment\" ? \"hash\" : \"search\"];\n    return new URLSearchParams(params.slice(1));\n  }\n};\n\n// src/errors/ErrorResponse.ts\nvar ErrorResponse = class extends Error {\n  constructor(args, form) {\n    var _a, _b, _c;\n    super(args.error_description || args.error || \"\");\n    this.form = form;\n    this.name = \"ErrorResponse\";\n    if (!args.error) {\n      Logger.error(\"ErrorResponse\", \"No error passed\");\n      throw new Error(\"No error passed\");\n    }\n    this.error = args.error;\n    this.error_description = (_a = args.error_description) != null ? _a : null;\n    this.error_uri = (_b = args.error_uri) != null ? _b : null;\n    this.state = args.userState;\n    this.session_state = (_c = args.session_state) != null ? _c : null;\n  }\n};\n\n// src/errors/ErrorTimeout.ts\nvar ErrorTimeout = class extends Error {\n  constructor(message) {\n    super(message);\n    this.name = \"ErrorTimeout\";\n  }\n};\n\n// src/AccessTokenEvents.ts\nvar AccessTokenEvents = class {\n  constructor(args) {\n    this._logger = new Logger(\"AccessTokenEvents\");\n    this._expiringTimer = new Timer(\"Access token expiring\");\n    this._expiredTimer = new Timer(\"Access token expired\");\n    this._expiringNotificationTimeInSeconds = args.expiringNotificationTimeInSeconds;\n  }\n  load(container) {\n    const logger2 = this._logger.create(\"load\");\n    if (container.access_token && container.expires_in !== void 0) {\n      const duration = container.expires_in;\n      logger2.debug(\"access token present, remaining duration:\", duration);\n      if (duration > 0) {\n        let expiring = duration - this._expiringNotificationTimeInSeconds;\n        if (expiring <= 0) {\n          expiring = 1;\n        }\n        logger2.debug(\"registering expiring timer, raising in\", expiring, \"seconds\");\n        this._expiringTimer.init(expiring);\n      } else {\n        logger2.debug(\"canceling existing expiring timer because we're past expiration.\");\n        this._expiringTimer.cancel();\n      }\n      const expired = duration + 1;\n      logger2.debug(\"registering expired timer, raising in\", expired, \"seconds\");\n      this._expiredTimer.init(expired);\n    } else {\n      this._expiringTimer.cancel();\n      this._expiredTimer.cancel();\n    }\n  }\n  unload() {\n    this._logger.debug(\"unload: canceling existing access token timers\");\n    this._expiringTimer.cancel();\n    this._expiredTimer.cancel();\n  }\n  addAccessTokenExpiring(cb) {\n    return this._expiringTimer.addHandler(cb);\n  }\n  removeAccessTokenExpiring(cb) {\n    this._expiringTimer.removeHandler(cb);\n  }\n  addAccessTokenExpired(cb) {\n    return this._expiredTimer.addHandler(cb);\n  }\n  removeAccessTokenExpired(cb) {\n    this._expiredTimer.removeHandler(cb);\n  }\n};\n\n// src/CheckSessionIFrame.ts\nvar CheckSessionIFrame = class {\n  constructor(_callback, _client_id, url, _intervalInSeconds, _stopOnError) {\n    this._callback = _callback;\n    this._client_id = _client_id;\n    this._intervalInSeconds = _intervalInSeconds;\n    this._stopOnError = _stopOnError;\n    this._logger = new Logger(\"CheckSessionIFrame\");\n    this._timer = null;\n    this._session_state = null;\n    this._message = (e) => {\n      if (e.origin === this._frame_origin && e.source === this._frame.contentWindow) {\n        if (e.data === \"error\") {\n          this._logger.error(\"error message from check session op iframe\");\n          if (this._stopOnError) {\n            this.stop();\n          }\n        } else if (e.data === \"changed\") {\n          this._logger.debug(\"changed message from check session op iframe\");\n          this.stop();\n          void this._callback();\n        } else {\n          this._logger.debug(e.data + \" message from check session op iframe\");\n        }\n      }\n    };\n    const parsedUrl = new URL(url);\n    this._frame_origin = parsedUrl.origin;\n    this._frame = window.document.createElement(\"iframe\");\n    this._frame.style.visibility = \"hidden\";\n    this._frame.style.position = \"fixed\";\n    this._frame.style.left = \"-1000px\";\n    this._frame.style.top = \"0\";\n    this._frame.width = \"0\";\n    this._frame.height = \"0\";\n    this._frame.src = parsedUrl.href;\n  }\n  load() {\n    return new Promise((resolve) => {\n      this._frame.onload = () => {\n        resolve();\n      };\n      window.document.body.appendChild(this._frame);\n      window.addEventListener(\"message\", this._message, false);\n    });\n  }\n  start(session_state) {\n    if (this._session_state === session_state) {\n      return;\n    }\n    this._logger.create(\"start\");\n    this.stop();\n    this._session_state = session_state;\n    const send = () => {\n      if (!this._frame.contentWindow || !this._session_state) {\n        return;\n      }\n      this._frame.contentWindow.postMessage(this._client_id + \" \" + this._session_state, this._frame_origin);\n    };\n    send();\n    this._timer = setInterval(send, this._intervalInSeconds * 1e3);\n  }\n  stop() {\n    this._logger.create(\"stop\");\n    this._session_state = null;\n    if (this._timer) {\n      clearInterval(this._timer);\n      this._timer = null;\n    }\n  }\n};\n\n// src/InMemoryWebStorage.ts\nvar InMemoryWebStorage = class {\n  constructor() {\n    this._logger = new Logger(\"InMemoryWebStorage\");\n    this._data = {};\n  }\n  clear() {\n    this._logger.create(\"clear\");\n    this._data = {};\n  }\n  getItem(key) {\n    this._logger.create(`getItem('${key}')`);\n    return this._data[key];\n  }\n  setItem(key, value) {\n    this._logger.create(`setItem('${key}')`);\n    this._data[key] = value;\n  }\n  removeItem(key) {\n    this._logger.create(`removeItem('${key}')`);\n    delete this._data[key];\n  }\n  get length() {\n    return Object.getOwnPropertyNames(this._data).length;\n  }\n  key(index) {\n    return Object.getOwnPropertyNames(this._data)[index];\n  }\n};\n\n// src/JsonService.ts\nvar JsonService = class {\n  constructor(additionalContentTypes = [], _jwtHandler = null) {\n    this._jwtHandler = _jwtHandler;\n    this._logger = new Logger(\"JsonService\");\n    this._contentTypes = [];\n    this._contentTypes.push(...additionalContentTypes, \"application/json\");\n    if (_jwtHandler) {\n      this._contentTypes.push(\"application/jwt\");\n    }\n  }\n  async fetchWithTimeout(input, init = {}) {\n    const { timeoutInSeconds, ...initFetch } = init;\n    if (!timeoutInSeconds) {\n      return await fetch(input, initFetch);\n    }\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), timeoutInSeconds * 1e3);\n    try {\n      const response = await fetch(input, {\n        ...init,\n        signal: controller.signal\n      });\n      return response;\n    } catch (err) {\n      if (err instanceof DOMException && err.name === \"AbortError\") {\n        throw new ErrorTimeout(\"Network timed out\");\n      }\n      throw err;\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n  async getJson(url, {\n    token\n  } = {}) {\n    const logger2 = this._logger.create(\"getJson\");\n    const headers = {\n      \"Accept\": this._contentTypes.join(\", \")\n    };\n    if (token) {\n      logger2.debug(\"token passed, setting Authorization header\");\n      headers[\"Authorization\"] = \"Bearer \" + token;\n    }\n    let response;\n    try {\n      logger2.debug(\"url:\", url);\n      response = await this.fetchWithTimeout(url, { method: \"GET\", headers });\n    } catch (err) {\n      logger2.error(\"Network Error\");\n      throw err;\n    }\n    logger2.debug(\"HTTP response received, status\", response.status);\n    const contentType = response.headers.get(\"Content-Type\");\n    if (contentType && !this._contentTypes.find((item) => contentType.startsWith(item))) {\n      logger2.throw(new Error(`Invalid response Content-Type: ${contentType != null ? contentType : \"undefined\"}, from URL: ${url}`));\n    }\n    if (response.ok && this._jwtHandler && (contentType == null ? void 0 : contentType.startsWith(\"application/jwt\"))) {\n      return await this._jwtHandler(await response.text());\n    }\n    let json;\n    try {\n      json = await response.json();\n    } catch (err) {\n      logger2.error(\"Error parsing JSON response\", err);\n      if (response.ok)\n        throw err;\n      throw new Error(`${response.statusText} (${response.status})`);\n    }\n    if (!response.ok) {\n      logger2.error(\"Error from server:\", json);\n      if (json.error) {\n        throw new ErrorResponse(json);\n      }\n      throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n    }\n    return json;\n  }\n  async postForm(url, {\n    body,\n    basicAuth,\n    timeoutInSeconds,\n    initCredentials\n  }) {\n    const logger2 = this._logger.create(\"postForm\");\n    const headers = {\n      \"Accept\": this._contentTypes.join(\", \"),\n      \"Content-Type\": \"application/x-www-form-urlencoded\"\n    };\n    if (basicAuth !== void 0) {\n      headers[\"Authorization\"] = \"Basic \" + basicAuth;\n    }\n    let response;\n    try {\n      logger2.debug(\"url:\", url);\n      response = await this.fetchWithTimeout(url, { method: \"POST\", headers, body, timeoutInSeconds, credentials: initCredentials });\n    } catch (err) {\n      logger2.error(\"Network error\");\n      throw err;\n    }\n    logger2.debug(\"HTTP response received, status\", response.status);\n    const contentType = response.headers.get(\"Content-Type\");\n    if (contentType && !this._contentTypes.find((item) => contentType.startsWith(item))) {\n      throw new Error(`Invalid response Content-Type: ${contentType != null ? contentType : \"undefined\"}, from URL: ${url}`);\n    }\n    const responseText = await response.text();\n    let json = {};\n    if (responseText) {\n      try {\n        json = JSON.parse(responseText);\n      } catch (err) {\n        logger2.error(\"Error parsing JSON response\", err);\n        if (response.ok)\n          throw err;\n        throw new Error(`${response.statusText} (${response.status})`);\n      }\n    }\n    if (!response.ok) {\n      logger2.error(\"Error from server:\", json);\n      if (json.error) {\n        throw new ErrorResponse(json, body);\n      }\n      throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n    }\n    return json;\n  }\n};\n\n// src/MetadataService.ts\nvar MetadataService = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"MetadataService\");\n    this._jsonService = new JsonService([\"application/jwk-set+json\"]);\n    this._signingKeys = null;\n    this._metadata = null;\n    this._metadataUrl = this._settings.metadataUrl;\n    if (this._settings.signingKeys) {\n      this._logger.debug(\"using signingKeys from settings\");\n      this._signingKeys = this._settings.signingKeys;\n    }\n    if (this._settings.metadata) {\n      this._logger.debug(\"using metadata from settings\");\n      this._metadata = this._settings.metadata;\n    }\n  }\n  resetSigningKeys() {\n    this._signingKeys = null;\n  }\n  async getMetadata() {\n    const logger2 = this._logger.create(\"getMetadata\");\n    if (this._metadata) {\n      logger2.debug(\"using cached values\");\n      return this._metadata;\n    }\n    if (!this._metadataUrl) {\n      logger2.throw(new Error(\"No authority or metadataUrl configured on settings\"));\n      throw null;\n    }\n    logger2.debug(\"getting metadata from\", this._metadataUrl);\n    const metadata = await this._jsonService.getJson(this._metadataUrl);\n    logger2.debug(\"merging remote JSON with seed metadata\");\n    this._metadata = Object.assign({}, this._settings.metadataSeed, metadata);\n    return this._metadata;\n  }\n  getIssuer() {\n    return this._getMetadataProperty(\"issuer\");\n  }\n  getAuthorizationEndpoint() {\n    return this._getMetadataProperty(\"authorization_endpoint\");\n  }\n  getUserInfoEndpoint() {\n    return this._getMetadataProperty(\"userinfo_endpoint\");\n  }\n  getTokenEndpoint(optional = true) {\n    return this._getMetadataProperty(\"token_endpoint\", optional);\n  }\n  getCheckSessionIframe() {\n    return this._getMetadataProperty(\"check_session_iframe\", true);\n  }\n  getEndSessionEndpoint() {\n    return this._getMetadataProperty(\"end_session_endpoint\", true);\n  }\n  getRevocationEndpoint(optional = true) {\n    return this._getMetadataProperty(\"revocation_endpoint\", optional);\n  }\n  getKeysEndpoint(optional = true) {\n    return this._getMetadataProperty(\"jwks_uri\", optional);\n  }\n  async _getMetadataProperty(name, optional = false) {\n    const logger2 = this._logger.create(`_getMetadataProperty('${name}')`);\n    const metadata = await this.getMetadata();\n    logger2.debug(\"resolved\");\n    if (metadata[name] === void 0) {\n      if (optional === true) {\n        logger2.warn(\"Metadata does not contain optional property\");\n        return void 0;\n      }\n      logger2.throw(new Error(\"Metadata does not contain property \" + name));\n    }\n    return metadata[name];\n  }\n  async getSigningKeys() {\n    const logger2 = this._logger.create(\"getSigningKeys\");\n    if (this._signingKeys) {\n      logger2.debug(\"returning signingKeys from cache\");\n      return this._signingKeys;\n    }\n    const jwks_uri = await this.getKeysEndpoint(false);\n    logger2.debug(\"got jwks_uri\", jwks_uri);\n    const keySet = await this._jsonService.getJson(jwks_uri);\n    logger2.debug(\"got key set\", keySet);\n    if (!Array.isArray(keySet.keys)) {\n      logger2.throw(new Error(\"Missing keys on keyset\"));\n      throw null;\n    }\n    this._signingKeys = keySet.keys;\n    return this._signingKeys;\n  }\n};\n\n// src/WebStorageStateStore.ts\nvar WebStorageStateStore = class {\n  constructor({ prefix = \"oidc.\", store = localStorage } = {}) {\n    this._logger = new Logger(\"WebStorageStateStore\");\n    this._store = store;\n    this._prefix = prefix;\n  }\n  set(key, value) {\n    this._logger.create(`set('${key}')`);\n    key = this._prefix + key;\n    this._store.setItem(key, value);\n    return Promise.resolve();\n  }\n  get(key) {\n    this._logger.create(`get('${key}')`);\n    key = this._prefix + key;\n    const item = this._store.getItem(key);\n    return Promise.resolve(item);\n  }\n  remove(key) {\n    this._logger.create(`remove('${key}')`);\n    key = this._prefix + key;\n    const item = this._store.getItem(key);\n    this._store.removeItem(key);\n    return Promise.resolve(item);\n  }\n  getAllKeys() {\n    this._logger.create(\"getAllKeys\");\n    const keys = [];\n    for (let index = 0; index < this._store.length; index++) {\n      const key = this._store.key(index);\n      if (key && key.indexOf(this._prefix) === 0) {\n        keys.push(key.substr(this._prefix.length));\n      }\n    }\n    return Promise.resolve(keys);\n  }\n};\n\n// src/OidcClientSettings.ts\nvar DefaultResponseType = \"code\";\nvar DefaultScope = \"openid\";\nvar DefaultClientAuthentication = \"client_secret_post\";\nvar DefaultResponseMode = \"query\";\nvar DefaultStaleStateAgeInSeconds = 60 * 15;\nvar DefaultClockSkewInSeconds = 60 * 5;\nvar OidcClientSettingsStore = class {\n  constructor({\n    authority,\n    metadataUrl,\n    metadata,\n    signingKeys,\n    metadataSeed,\n    client_id,\n    client_secret,\n    response_type = DefaultResponseType,\n    scope = DefaultScope,\n    redirect_uri,\n    post_logout_redirect_uri,\n    client_authentication = DefaultClientAuthentication,\n    prompt,\n    display,\n    max_age,\n    ui_locales,\n    acr_values,\n    resource,\n    response_mode = DefaultResponseMode,\n    filterProtocolClaims = true,\n    loadUserInfo = false,\n    staleStateAgeInSeconds = DefaultStaleStateAgeInSeconds,\n    clockSkewInSeconds = DefaultClockSkewInSeconds,\n    userInfoJwtIssuer = \"OP\",\n    mergeClaims = false,\n    stateStore,\n    refreshTokenCredentials = \"same-origin\",\n    extraQueryParams = {},\n    extraTokenParams = {}\n  }) {\n    this.authority = authority;\n    if (metadataUrl) {\n      this.metadataUrl = metadataUrl;\n    } else {\n      this.metadataUrl = authority;\n      if (authority) {\n        if (!this.metadataUrl.endsWith(\"/\")) {\n          this.metadataUrl += \"/\";\n        }\n        this.metadataUrl += \".well-known/openid-configuration\";\n      }\n    }\n    this.metadata = metadata;\n    this.metadataSeed = metadataSeed;\n    this.signingKeys = signingKeys;\n    this.client_id = client_id;\n    this.client_secret = client_secret;\n    this.response_type = response_type;\n    this.scope = scope;\n    this.redirect_uri = redirect_uri;\n    this.post_logout_redirect_uri = post_logout_redirect_uri;\n    this.client_authentication = client_authentication;\n    this.prompt = prompt;\n    this.display = display;\n    this.max_age = max_age;\n    this.ui_locales = ui_locales;\n    this.acr_values = acr_values;\n    this.resource = resource;\n    this.response_mode = response_mode;\n    this.filterProtocolClaims = !!filterProtocolClaims;\n    this.loadUserInfo = !!loadUserInfo;\n    this.staleStateAgeInSeconds = staleStateAgeInSeconds;\n    this.clockSkewInSeconds = clockSkewInSeconds;\n    this.userInfoJwtIssuer = userInfoJwtIssuer;\n    this.mergeClaims = !!mergeClaims;\n    this.refreshTokenCredentials = refreshTokenCredentials;\n    if (stateStore) {\n      this.stateStore = stateStore;\n    } else {\n      const store = typeof window !== \"undefined\" ? window.localStorage : new InMemoryWebStorage();\n      this.stateStore = new WebStorageStateStore({ store });\n    }\n    this.extraQueryParams = extraQueryParams;\n    this.extraTokenParams = extraTokenParams;\n  }\n};\n\n// src/UserInfoService.ts\nvar UserInfoService = class {\n  constructor(_metadataService) {\n    this._metadataService = _metadataService;\n    this._logger = new Logger(\"UserInfoService\");\n    this._getClaimsFromJwt = async (responseText) => {\n      const logger2 = this._logger.create(\"_getClaimsFromJwt\");\n      try {\n        const payload = JwtUtils.decode(responseText);\n        logger2.debug(\"JWT decoding successful\");\n        return payload;\n      } catch (err) {\n        logger2.error(\"Error parsing JWT response\");\n        throw err;\n      }\n    };\n    this._jsonService = new JsonService(void 0, this._getClaimsFromJwt);\n  }\n  async getClaims(token) {\n    const logger2 = this._logger.create(\"getClaims\");\n    if (!token) {\n      this._logger.throw(new Error(\"No token passed\"));\n    }\n    const url = await this._metadataService.getUserInfoEndpoint();\n    logger2.debug(\"got userinfo url\", url);\n    const claims = await this._jsonService.getJson(url, { token });\n    logger2.debug(\"got claims\", claims);\n    return claims;\n  }\n};\n\n// src/TokenClient.ts\nvar TokenClient = class {\n  constructor(_settings, _metadataService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new Logger(\"TokenClient\");\n    this._jsonService = new JsonService();\n  }\n  async exchangeCode({\n    grant_type = \"authorization_code\",\n    redirect_uri = this._settings.redirect_uri,\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeCode\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    if (!redirect_uri) {\n      logger2.throw(new Error(\"A redirect_uri is required\"));\n    }\n    if (!args.code) {\n      logger2.throw(new Error(\"A code is required\"));\n    }\n    if (!args.code_verifier) {\n      logger2.throw(new Error(\"A code_verifier is required\"));\n    }\n    const params = new URLSearchParams({ grant_type, redirect_uri });\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    let basicAuth;\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        if (!client_secret) {\n          logger2.throw(new Error(\"A client_secret is required\"));\n          throw null;\n        }\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n    }\n    const url = await this._metadataService.getTokenEndpoint(false);\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, { body: params, basicAuth });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  async exchangeRefreshToken({\n    grant_type = \"refresh_token\",\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    timeoutInSeconds,\n    refreshTokenCredentials,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeRefreshToken\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    if (!args.refresh_token) {\n      logger2.throw(new Error(\"A refresh_token is required\"));\n    }\n    const params = new URLSearchParams({ grant_type });\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    let basicAuth;\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        if (!client_secret) {\n          logger2.throw(new Error(\"A client_secret is required\"));\n          throw null;\n        }\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n    }\n    const url = await this._metadataService.getTokenEndpoint(false);\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, { body: params, basicAuth, timeoutInSeconds, initCredentials: refreshTokenCredentials });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  async revoke(args) {\n    var _a;\n    const logger2 = this._logger.create(\"revoke\");\n    if (!args.token) {\n      logger2.throw(new Error(\"A token is required\"));\n    }\n    const url = await this._metadataService.getRevocationEndpoint(false);\n    logger2.debug(`got revocation endpoint, revoking ${(_a = args.token_type_hint) != null ? _a : \"default token type\"}`);\n    const params = new URLSearchParams();\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    params.set(\"client_id\", this._settings.client_id);\n    if (this._settings.client_secret) {\n      params.set(\"client_secret\", this._settings.client_secret);\n    }\n    await this._jsonService.postForm(url, { body: params });\n    logger2.debug(\"got response\");\n  }\n};\n\n// src/ResponseValidator.ts\nvar ProtocolClaims = [\n  \"iss\",\n  \"aud\",\n  \"exp\",\n  \"nbf\",\n  \"iat\",\n  \"jti\",\n  \"auth_time\",\n  \"nonce\",\n  \"acr\",\n  \"amr\",\n  \"azp\",\n  \"at_hash\"\n];\nvar ResponseValidator = class {\n  constructor(_settings, _metadataService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new Logger(\"ResponseValidator\");\n    this._userInfoService = new UserInfoService(this._metadataService);\n    this._tokenClient = new TokenClient(this._settings, this._metadataService);\n  }\n  async validateSigninResponse(response, state) {\n    const logger2 = this._logger.create(\"validateSigninResponse\");\n    this._processSigninState(response, state);\n    logger2.debug(\"state processed\");\n    await this._processCode(response, state);\n    logger2.debug(\"code processed\");\n    if (response.isOpenId) {\n      this._validateIdTokenAttributes(response);\n    }\n    logger2.debug(\"tokens validated\");\n    await this._processClaims(response, state == null ? void 0 : state.skipUserInfo, response.isOpenId);\n    logger2.debug(\"claims processed\");\n  }\n  async validateRefreshResponse(response, state) {\n    var _a, _b;\n    const logger2 = this._logger.create(\"validateRefreshResponse\");\n    response.userState = state.data;\n    (_a = response.session_state) != null ? _a : response.session_state = state.session_state;\n    (_b = response.scope) != null ? _b : response.scope = state.scope;\n    const hasIdToken = response.isOpenId && !!response.id_token;\n    if (hasIdToken) {\n      this._validateIdTokenAttributes(response, state.id_token);\n      logger2.debug(\"ID Token validated\");\n    }\n    await this._processClaims(response, false, hasIdToken);\n    logger2.debug(\"claims processed\");\n  }\n  validateSignoutResponse(response, state) {\n    const logger2 = this._logger.create(\"validateSignoutResponse\");\n    if (state.id !== response.state) {\n      logger2.throw(new Error(\"State does not match\"));\n    }\n    logger2.debug(\"state validated\");\n    response.userState = state.data;\n    if (response.error) {\n      logger2.warn(\"Response was error\", response.error);\n      throw new ErrorResponse(response);\n    }\n  }\n  _processSigninState(response, state) {\n    var _a;\n    const logger2 = this._logger.create(\"_processSigninState\");\n    if (state.id !== response.state) {\n      logger2.throw(new Error(\"State does not match\"));\n    }\n    if (!state.client_id) {\n      logger2.throw(new Error(\"No client_id on state\"));\n    }\n    if (!state.authority) {\n      logger2.throw(new Error(\"No authority on state\"));\n    }\n    if (this._settings.authority !== state.authority) {\n      logger2.throw(new Error(\"authority mismatch on settings vs. signin state\"));\n    }\n    if (this._settings.client_id && this._settings.client_id !== state.client_id) {\n      logger2.throw(new Error(\"client_id mismatch on settings vs. signin state\"));\n    }\n    logger2.debug(\"state validated\");\n    response.userState = state.data;\n    (_a = response.scope) != null ? _a : response.scope = state.scope;\n    if (response.error) {\n      logger2.warn(\"Response was error\", response.error);\n      throw new ErrorResponse(response);\n    }\n    if (state.code_verifier && !response.code) {\n      logger2.throw(new Error(\"Expected code in response\"));\n    }\n    if (!state.code_verifier && response.code) {\n      logger2.throw(new Error(\"Unexpected code in response\"));\n    }\n  }\n  async _processClaims(response, skipUserInfo = false, validateSub = true) {\n    const logger2 = this._logger.create(\"_processClaims\");\n    response.profile = this._filterProtocolClaims(response.profile);\n    if (skipUserInfo || !this._settings.loadUserInfo || !response.access_token) {\n      logger2.debug(\"not loading user info\");\n      return;\n    }\n    logger2.debug(\"loading user info\");\n    const claims = await this._userInfoService.getClaims(response.access_token);\n    logger2.debug(\"user info claims received from user info endpoint\");\n    if (validateSub && claims.sub !== response.profile.sub) {\n      logger2.throw(new Error(\"subject from UserInfo response does not match subject in ID Token\"));\n    }\n    response.profile = this._mergeClaims(response.profile, this._filterProtocolClaims(claims));\n    logger2.debug(\"user info claims received, updated profile:\", response.profile);\n  }\n  _mergeClaims(claims1, claims2) {\n    const result = { ...claims1 };\n    for (const [claim, values] of Object.entries(claims2)) {\n      for (const value of Array.isArray(values) ? values : [values]) {\n        const previousValue = result[claim];\n        if (!previousValue) {\n          result[claim] = value;\n        } else if (Array.isArray(previousValue)) {\n          if (!previousValue.includes(value)) {\n            previousValue.push(value);\n          }\n        } else if (result[claim] !== value) {\n          if (typeof value === \"object\" && this._settings.mergeClaims) {\n            result[claim] = this._mergeClaims(previousValue, value);\n          } else {\n            result[claim] = [previousValue, value];\n          }\n        }\n      }\n    }\n    return result;\n  }\n  _filterProtocolClaims(claims) {\n    const result = { ...claims };\n    if (this._settings.filterProtocolClaims) {\n      for (const type of ProtocolClaims) {\n        delete result[type];\n      }\n    }\n    return result;\n  }\n  async _processCode(response, state) {\n    const logger2 = this._logger.create(\"_processCode\");\n    if (response.code) {\n      logger2.debug(\"Validating code\");\n      const tokenResponse = await this._tokenClient.exchangeCode({\n        client_id: state.client_id,\n        client_secret: state.client_secret,\n        code: response.code,\n        redirect_uri: state.redirect_uri,\n        code_verifier: state.code_verifier,\n        ...state.extraTokenParams\n      });\n      Object.assign(response, tokenResponse);\n    } else {\n      logger2.debug(\"No code to process\");\n    }\n  }\n  _validateIdTokenAttributes(response, currentToken) {\n    var _a;\n    const logger2 = this._logger.create(\"_validateIdTokenAttributes\");\n    logger2.debug(\"decoding ID Token JWT\");\n    const profile = JwtUtils.decode((_a = response.id_token) != null ? _a : \"\");\n    if (!profile.sub) {\n      logger2.throw(new Error(\"ID Token is missing a subject claim\"));\n    }\n    if (currentToken) {\n      const current = JwtUtils.decode(currentToken);\n      if (current.sub !== profile.sub) {\n        logger2.throw(new Error(\"sub in id_token does not match current sub\"));\n      }\n      if (current.auth_time && current.auth_time !== profile.auth_time) {\n        logger2.throw(new Error(\"auth_time in id_token does not match original auth_time\"));\n      }\n      if (current.azp && current.azp !== profile.azp) {\n        logger2.throw(new Error(\"azp in id_token does not match original azp\"));\n      }\n      if (!current.azp && profile.azp) {\n        logger2.throw(new Error(\"azp not in id_token, but present in original id_token\"));\n      }\n    }\n    response.profile = profile;\n  }\n};\n\n// src/State.ts\nvar State = class {\n  constructor(args) {\n    this.id = args.id || CryptoUtils.generateUUIDv4();\n    this.data = args.data;\n    if (args.created && args.created > 0) {\n      this.created = args.created;\n    } else {\n      this.created = Timer.getEpochTime();\n    }\n    this.request_type = args.request_type;\n  }\n  toStorageString() {\n    new Logger(\"State\").create(\"toStorageString\");\n    return JSON.stringify({\n      id: this.id,\n      data: this.data,\n      created: this.created,\n      request_type: this.request_type\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"State\", \"fromStorageString\");\n    return new State(JSON.parse(storageString));\n  }\n  static async clearStaleState(storage, age) {\n    const logger2 = Logger.createStatic(\"State\", \"clearStaleState\");\n    const cutoff = Timer.getEpochTime() - age;\n    const keys = await storage.getAllKeys();\n    logger2.debug(\"got keys\", keys);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const item = await storage.get(key);\n      let remove = false;\n      if (item) {\n        try {\n          const state = State.fromStorageString(item);\n          logger2.debug(\"got item from key:\", key, state.created);\n          if (state.created <= cutoff) {\n            remove = true;\n          }\n        } catch (err) {\n          logger2.error(\"Error parsing state for key:\", key, err);\n          remove = true;\n        }\n      } else {\n        logger2.debug(\"no item in storage for key:\", key);\n        remove = true;\n      }\n      if (remove) {\n        logger2.debug(\"removed item for key:\", key);\n        void storage.remove(key);\n      }\n    }\n  }\n};\n\n// src/SigninState.ts\nvar SigninState = class extends State {\n  constructor(args) {\n    super(args);\n    if (args.code_verifier === true) {\n      this.code_verifier = CryptoUtils.generateCodeVerifier();\n    } else if (args.code_verifier) {\n      this.code_verifier = args.code_verifier;\n    }\n    if (this.code_verifier) {\n      this.code_challenge = CryptoUtils.generateCodeChallenge(this.code_verifier);\n    }\n    this.authority = args.authority;\n    this.client_id = args.client_id;\n    this.redirect_uri = args.redirect_uri;\n    this.scope = args.scope;\n    this.client_secret = args.client_secret;\n    this.extraTokenParams = args.extraTokenParams;\n    this.response_mode = args.response_mode;\n    this.skipUserInfo = args.skipUserInfo;\n  }\n  toStorageString() {\n    new Logger(\"SigninState\").create(\"toStorageString\");\n    return JSON.stringify({\n      id: this.id,\n      data: this.data,\n      created: this.created,\n      request_type: this.request_type,\n      code_verifier: this.code_verifier,\n      authority: this.authority,\n      client_id: this.client_id,\n      redirect_uri: this.redirect_uri,\n      scope: this.scope,\n      client_secret: this.client_secret,\n      extraTokenParams: this.extraTokenParams,\n      response_mode: this.response_mode,\n      skipUserInfo: this.skipUserInfo\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"SigninState\", \"fromStorageString\");\n    const data = JSON.parse(storageString);\n    return new SigninState(data);\n  }\n};\n\n// src/SigninRequest.ts\nvar SigninRequest = class {\n  constructor({\n    url,\n    authority,\n    client_id,\n    redirect_uri,\n    response_type,\n    scope,\n    state_data,\n    response_mode,\n    request_type,\n    client_secret,\n    nonce,\n    skipUserInfo,\n    extraQueryParams,\n    extraTokenParams,\n    ...optionalParams\n  }) {\n    this._logger = new Logger(\"SigninRequest\");\n    if (!url) {\n      this._logger.error(\"ctor: No url passed\");\n      throw new Error(\"url\");\n    }\n    if (!client_id) {\n      this._logger.error(\"ctor: No client_id passed\");\n      throw new Error(\"client_id\");\n    }\n    if (!redirect_uri) {\n      this._logger.error(\"ctor: No redirect_uri passed\");\n      throw new Error(\"redirect_uri\");\n    }\n    if (!response_type) {\n      this._logger.error(\"ctor: No response_type passed\");\n      throw new Error(\"response_type\");\n    }\n    if (!scope) {\n      this._logger.error(\"ctor: No scope passed\");\n      throw new Error(\"scope\");\n    }\n    if (!authority) {\n      this._logger.error(\"ctor: No authority passed\");\n      throw new Error(\"authority\");\n    }\n    this.state = new SigninState({\n      data: state_data,\n      request_type,\n      code_verifier: true,\n      client_id,\n      authority,\n      redirect_uri,\n      response_mode,\n      client_secret,\n      scope,\n      extraTokenParams,\n      skipUserInfo\n    });\n    const parsedUrl = new URL(url);\n    parsedUrl.searchParams.append(\"client_id\", client_id);\n    parsedUrl.searchParams.append(\"redirect_uri\", redirect_uri);\n    parsedUrl.searchParams.append(\"response_type\", response_type);\n    parsedUrl.searchParams.append(\"scope\", scope);\n    if (nonce) {\n      parsedUrl.searchParams.append(\"nonce\", nonce);\n    }\n    parsedUrl.searchParams.append(\"state\", this.state.id);\n    if (this.state.code_challenge) {\n      parsedUrl.searchParams.append(\"code_challenge\", this.state.code_challenge);\n      parsedUrl.searchParams.append(\"code_challenge_method\", \"S256\");\n    }\n    for (const [key, value] of Object.entries({ response_mode, ...optionalParams, ...extraQueryParams })) {\n      if (value != null) {\n        parsedUrl.searchParams.append(key, value.toString());\n      }\n    }\n    this.url = parsedUrl.href;\n  }\n};\n\n// src/SigninResponse.ts\nvar OidcScope = \"openid\";\nvar SigninResponse = class {\n  constructor(params) {\n    this.access_token = \"\";\n    this.token_type = \"\";\n    this.profile = {};\n    this.state = params.get(\"state\");\n    this.session_state = params.get(\"session_state\");\n    this.error = params.get(\"error\");\n    this.error_description = params.get(\"error_description\");\n    this.error_uri = params.get(\"error_uri\");\n    this.code = params.get(\"code\");\n  }\n  get expires_in() {\n    if (this.expires_at === void 0) {\n      return void 0;\n    }\n    return this.expires_at - Timer.getEpochTime();\n  }\n  set expires_in(value) {\n    if (typeof value === \"string\")\n      value = Number(value);\n    if (value !== void 0 && value >= 0) {\n      this.expires_at = Math.floor(value) + Timer.getEpochTime();\n    }\n  }\n  get isOpenId() {\n    var _a;\n    return ((_a = this.scope) == null ? void 0 : _a.split(\" \").includes(OidcScope)) || !!this.id_token;\n  }\n};\n\n// src/SignoutRequest.ts\nvar SignoutRequest = class {\n  constructor({\n    url,\n    state_data,\n    id_token_hint,\n    post_logout_redirect_uri,\n    extraQueryParams,\n    request_type\n  }) {\n    this._logger = new Logger(\"SignoutRequest\");\n    if (!url) {\n      this._logger.error(\"ctor: No url passed\");\n      throw new Error(\"url\");\n    }\n    const parsedUrl = new URL(url);\n    if (id_token_hint) {\n      parsedUrl.searchParams.append(\"id_token_hint\", id_token_hint);\n    }\n    if (post_logout_redirect_uri) {\n      parsedUrl.searchParams.append(\"post_logout_redirect_uri\", post_logout_redirect_uri);\n      if (state_data) {\n        this.state = new State({ data: state_data, request_type });\n        parsedUrl.searchParams.append(\"state\", this.state.id);\n      }\n    }\n    for (const [key, value] of Object.entries({ ...extraQueryParams })) {\n      if (value != null) {\n        parsedUrl.searchParams.append(key, value.toString());\n      }\n    }\n    this.url = parsedUrl.href;\n  }\n};\n\n// src/SignoutResponse.ts\nvar SignoutResponse = class {\n  constructor(params) {\n    this.state = params.get(\"state\");\n    this.error = params.get(\"error\");\n    this.error_description = params.get(\"error_description\");\n    this.error_uri = params.get(\"error_uri\");\n  }\n};\n\n// src/OidcClient.ts\nvar OidcClient = class {\n  constructor(settings) {\n    this._logger = new Logger(\"OidcClient\");\n    this.settings = new OidcClientSettingsStore(settings);\n    this.metadataService = new MetadataService(this.settings);\n    this._validator = new ResponseValidator(this.settings, this.metadataService);\n    this._tokenClient = new TokenClient(this.settings, this.metadataService);\n  }\n  async createSigninRequest({\n    state,\n    request,\n    request_uri,\n    request_type,\n    id_token_hint,\n    login_hint,\n    skipUserInfo,\n    nonce,\n    response_type = this.settings.response_type,\n    scope = this.settings.scope,\n    redirect_uri = this.settings.redirect_uri,\n    prompt = this.settings.prompt,\n    display = this.settings.display,\n    max_age = this.settings.max_age,\n    ui_locales = this.settings.ui_locales,\n    acr_values = this.settings.acr_values,\n    resource = this.settings.resource,\n    response_mode = this.settings.response_mode,\n    extraQueryParams = this.settings.extraQueryParams,\n    extraTokenParams = this.settings.extraTokenParams\n  }) {\n    const logger2 = this._logger.create(\"createSigninRequest\");\n    if (response_type !== \"code\") {\n      throw new Error(\"Only the Authorization Code flow (with PKCE) is supported\");\n    }\n    const url = await this.metadataService.getAuthorizationEndpoint();\n    logger2.debug(\"Received authorization endpoint\", url);\n    const signinRequest = new SigninRequest({\n      url,\n      authority: this.settings.authority,\n      client_id: this.settings.client_id,\n      redirect_uri,\n      response_type,\n      scope,\n      state_data: state,\n      prompt,\n      display,\n      max_age,\n      ui_locales,\n      id_token_hint,\n      login_hint,\n      acr_values,\n      resource,\n      request,\n      request_uri,\n      extraQueryParams,\n      extraTokenParams,\n      request_type,\n      response_mode,\n      client_secret: this.settings.client_secret,\n      skipUserInfo,\n      nonce\n    });\n    await this.clearStaleState();\n    const signinState = signinRequest.state;\n    await this.settings.stateStore.set(signinState.id, signinState.toStorageString());\n    return signinRequest;\n  }\n  async readSigninResponseState(url, removeState = false) {\n    const logger2 = this._logger.create(\"readSigninResponseState\");\n    const response = new SigninResponse(UrlUtils.readParams(url, this.settings.response_mode));\n    if (!response.state) {\n      logger2.throw(new Error(\"No state in response\"));\n      throw null;\n    }\n    const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n    if (!storedStateString) {\n      logger2.throw(new Error(\"No matching state found in storage\"));\n      throw null;\n    }\n    const state = SigninState.fromStorageString(storedStateString);\n    return { state, response };\n  }\n  async processSigninResponse(url) {\n    const logger2 = this._logger.create(\"processSigninResponse\");\n    const { state, response } = await this.readSigninResponseState(url, true);\n    logger2.debug(\"received state from storage; validating response\");\n    await this._validator.validateSigninResponse(response, state);\n    return response;\n  }\n  async useRefreshToken({\n    state,\n    timeoutInSeconds\n  }) {\n    const logger2 = this._logger.create(\"useRefreshToken\");\n    const result = await this._tokenClient.exchangeRefreshToken({\n      refresh_token: state.refresh_token,\n      scope: state.scope,\n      timeoutInSeconds,\n      refreshTokenCredentials: this.settings.refreshTokenCredentials\n    });\n    const response = new SigninResponse(new URLSearchParams());\n    Object.assign(response, result);\n    logger2.debug(\"validating response\", response);\n    await this._validator.validateRefreshResponse(response, state);\n    return response;\n  }\n  async createSignoutRequest({\n    state,\n    id_token_hint,\n    request_type,\n    post_logout_redirect_uri = this.settings.post_logout_redirect_uri,\n    extraQueryParams = this.settings.extraQueryParams\n  } = {}) {\n    const logger2 = this._logger.create(\"createSignoutRequest\");\n    const url = await this.metadataService.getEndSessionEndpoint();\n    if (!url) {\n      logger2.throw(new Error(\"No end session endpoint\"));\n      throw null;\n    }\n    logger2.debug(\"Received end session endpoint\", url);\n    const request = new SignoutRequest({\n      url,\n      id_token_hint,\n      post_logout_redirect_uri,\n      state_data: state,\n      extraQueryParams,\n      request_type\n    });\n    await this.clearStaleState();\n    const signoutState = request.state;\n    if (signoutState) {\n      logger2.debug(\"Signout request has state to persist\");\n      await this.settings.stateStore.set(signoutState.id, signoutState.toStorageString());\n    }\n    return request;\n  }\n  async readSignoutResponseState(url, removeState = false) {\n    const logger2 = this._logger.create(\"readSignoutResponseState\");\n    const response = new SignoutResponse(UrlUtils.readParams(url, this.settings.response_mode));\n    if (!response.state) {\n      logger2.debug(\"No state in response\");\n      if (response.error) {\n        logger2.warn(\"Response was error:\", response.error);\n        throw new ErrorResponse(response);\n      }\n      return { state: void 0, response };\n    }\n    const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n    if (!storedStateString) {\n      logger2.throw(new Error(\"No matching state found in storage\"));\n      throw null;\n    }\n    const state = State.fromStorageString(storedStateString);\n    return { state, response };\n  }\n  async processSignoutResponse(url) {\n    const logger2 = this._logger.create(\"processSignoutResponse\");\n    const { state, response } = await this.readSignoutResponseState(url, true);\n    if (state) {\n      logger2.debug(\"Received state from storage; validating response\");\n      this._validator.validateSignoutResponse(response, state);\n    } else {\n      logger2.debug(\"No state from storage; skipping response validation\");\n    }\n    return response;\n  }\n  clearStaleState() {\n    this._logger.create(\"clearStaleState\");\n    return State.clearStaleState(this.settings.stateStore, this.settings.staleStateAgeInSeconds);\n  }\n  async revokeToken(token, type) {\n    this._logger.create(\"revokeToken\");\n    return await this._tokenClient.revoke({\n      token,\n      token_type_hint: type\n    });\n  }\n};\n\n// src/SessionMonitor.ts\nvar SessionMonitor = class {\n  constructor(_userManager) {\n    this._userManager = _userManager;\n    this._logger = new Logger(\"SessionMonitor\");\n    this._start = async (user) => {\n      const session_state = user.session_state;\n      if (!session_state) {\n        return;\n      }\n      const logger2 = this._logger.create(\"_start\");\n      if (user.profile) {\n        this._sub = user.profile.sub;\n        this._sid = user.profile.sid;\n        logger2.debug(\"session_state\", session_state, \", sub\", this._sub);\n      } else {\n        this._sub = void 0;\n        this._sid = void 0;\n        logger2.debug(\"session_state\", session_state, \", anonymous user\");\n      }\n      if (this._checkSessionIFrame) {\n        this._checkSessionIFrame.start(session_state);\n        return;\n      }\n      try {\n        const url = await this._userManager.metadataService.getCheckSessionIframe();\n        if (url) {\n          logger2.debug(\"initializing check session iframe\");\n          const client_id = this._userManager.settings.client_id;\n          const intervalInSeconds = this._userManager.settings.checkSessionIntervalInSeconds;\n          const stopOnError = this._userManager.settings.stopCheckSessionOnError;\n          const checkSessionIFrame = new CheckSessionIFrame(this._callback, client_id, url, intervalInSeconds, stopOnError);\n          await checkSessionIFrame.load();\n          this._checkSessionIFrame = checkSessionIFrame;\n          checkSessionIFrame.start(session_state);\n        } else {\n          logger2.warn(\"no check session iframe found in the metadata\");\n        }\n      } catch (err) {\n        logger2.error(\"Error from getCheckSessionIframe:\", err instanceof Error ? err.message : err);\n      }\n    };\n    this._stop = () => {\n      const logger2 = this._logger.create(\"_stop\");\n      this._sub = void 0;\n      this._sid = void 0;\n      if (this._checkSessionIFrame) {\n        this._checkSessionIFrame.stop();\n      }\n      if (this._userManager.settings.monitorAnonymousSession) {\n        const timerHandle = setInterval(async () => {\n          clearInterval(timerHandle);\n          try {\n            const session = await this._userManager.querySessionStatus();\n            if (session) {\n              const tmpUser = {\n                session_state: session.session_state,\n                profile: session.sub && session.sid ? {\n                  sub: session.sub,\n                  sid: session.sid\n                } : null\n              };\n              void this._start(tmpUser);\n            }\n          } catch (err) {\n            logger2.error(\"error from querySessionStatus\", err instanceof Error ? err.message : err);\n          }\n        }, 1e3);\n      }\n    };\n    this._callback = async () => {\n      const logger2 = this._logger.create(\"_callback\");\n      try {\n        const session = await this._userManager.querySessionStatus();\n        let raiseEvent = true;\n        if (session && this._checkSessionIFrame) {\n          if (session.sub === this._sub) {\n            raiseEvent = false;\n            this._checkSessionIFrame.start(session.session_state);\n            if (session.sid === this._sid) {\n              logger2.debug(\"same sub still logged in at OP, restarting check session iframe; session_state\", session.session_state);\n            } else {\n              logger2.debug(\"same sub still logged in at OP, session state has changed, restarting check session iframe; session_state\", session.session_state);\n              this._userManager.events._raiseUserSessionChanged();\n            }\n          } else {\n            logger2.debug(\"different subject signed into OP\", session.sub);\n          }\n        } else {\n          logger2.debug(\"subject no longer signed into OP\");\n        }\n        if (raiseEvent) {\n          if (this._sub) {\n            this._userManager.events._raiseUserSignedOut();\n          } else {\n            this._userManager.events._raiseUserSignedIn();\n          }\n        } else {\n          logger2.debug(\"no change in session detected, no event to raise\");\n        }\n      } catch (err) {\n        if (this._sub) {\n          logger2.debug(\"Error calling queryCurrentSigninSession; raising signed out event\", err);\n          this._userManager.events._raiseUserSignedOut();\n        }\n      }\n    };\n    if (!_userManager) {\n      this._logger.throw(new Error(\"No user manager passed\"));\n    }\n    this._userManager.events.addUserLoaded(this._start);\n    this._userManager.events.addUserUnloaded(this._stop);\n    this._init().catch((err) => {\n      this._logger.error(err);\n    });\n  }\n  async _init() {\n    this._logger.create(\"_init\");\n    const user = await this._userManager.getUser();\n    if (user) {\n      void this._start(user);\n    } else if (this._userManager.settings.monitorAnonymousSession) {\n      const session = await this._userManager.querySessionStatus();\n      if (session) {\n        const tmpUser = {\n          session_state: session.session_state,\n          profile: session.sub && session.sid ? {\n            sub: session.sub,\n            sid: session.sid\n          } : null\n        };\n        void this._start(tmpUser);\n      }\n    }\n  }\n};\n\n// src/User.ts\nvar User = class {\n  constructor(args) {\n    var _a;\n    this.id_token = args.id_token;\n    this.session_state = (_a = args.session_state) != null ? _a : null;\n    this.access_token = args.access_token;\n    this.refresh_token = args.refresh_token;\n    this.token_type = args.token_type;\n    this.scope = args.scope;\n    this.profile = args.profile;\n    this.expires_at = args.expires_at;\n    this.state = args.userState;\n  }\n  get expires_in() {\n    if (this.expires_at === void 0) {\n      return void 0;\n    }\n    return this.expires_at - Timer.getEpochTime();\n  }\n  set expires_in(value) {\n    if (value !== void 0) {\n      this.expires_at = Math.floor(value) + Timer.getEpochTime();\n    }\n  }\n  get expired() {\n    const expires_in = this.expires_in;\n    if (expires_in === void 0) {\n      return void 0;\n    }\n    return expires_in <= 0;\n  }\n  get scopes() {\n    var _a, _b;\n    return (_b = (_a = this.scope) == null ? void 0 : _a.split(\" \")) != null ? _b : [];\n  }\n  toStorageString() {\n    new Logger(\"User\").create(\"toStorageString\");\n    return JSON.stringify({\n      id_token: this.id_token,\n      session_state: this.session_state,\n      access_token: this.access_token,\n      refresh_token: this.refresh_token,\n      token_type: this.token_type,\n      scope: this.scope,\n      profile: this.profile,\n      expires_at: this.expires_at\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"User\", \"fromStorageString\");\n    return new User(JSON.parse(storageString));\n  }\n};\n\n// src/navigators/AbstractChildWindow.ts\nvar messageSource = \"oidc-client\";\nvar AbstractChildWindow = class {\n  constructor() {\n    this._abort = new Event(\"Window navigation aborted\");\n    this._disposeHandlers = /* @__PURE__ */ new Set();\n    this._window = null;\n  }\n  async navigate(params) {\n    const logger2 = this._logger.create(\"navigate\");\n    if (!this._window) {\n      throw new Error(\"Attempted to navigate on a disposed window\");\n    }\n    logger2.debug(\"setting URL in window\");\n    this._window.location.replace(params.url);\n    const { url, keepOpen } = await new Promise((resolve, reject) => {\n      const listener = (e) => {\n        var _a;\n        const data = e.data;\n        const origin = (_a = params.scriptOrigin) != null ? _a : window.location.origin;\n        if (e.origin !== origin || (data == null ? void 0 : data.source) !== messageSource) {\n          return;\n        }\n        try {\n          const state = UrlUtils.readParams(data.url, params.response_mode).get(\"state\");\n          if (!state) {\n            logger2.warn(\"no state found in response url\");\n          }\n          if (e.source !== this._window && state !== params.state) {\n            return;\n          }\n        } catch (err) {\n          this._dispose();\n          reject(new Error(\"Invalid response from window\"));\n        }\n        resolve(data);\n      };\n      window.addEventListener(\"message\", listener, false);\n      this._disposeHandlers.add(() => window.removeEventListener(\"message\", listener, false));\n      this._disposeHandlers.add(this._abort.addHandler((reason) => {\n        this._dispose();\n        reject(reason);\n      }));\n    });\n    logger2.debug(\"got response from window\");\n    this._dispose();\n    if (!keepOpen) {\n      this.close();\n    }\n    return { url };\n  }\n  _dispose() {\n    this._logger.create(\"_dispose\");\n    for (const dispose of this._disposeHandlers) {\n      dispose();\n    }\n    this._disposeHandlers.clear();\n  }\n  static _notifyParent(parent, url, keepOpen = false, targetOrigin = window.location.origin) {\n    parent.postMessage({\n      source: messageSource,\n      url,\n      keepOpen\n    }, targetOrigin);\n  }\n};\n\n// src/UserManagerSettings.ts\nvar DefaultPopupWindowFeatures = {\n  location: false,\n  toolbar: false,\n  height: 640\n};\nvar DefaultPopupTarget = \"_blank\";\nvar DefaultAccessTokenExpiringNotificationTimeInSeconds = 60;\nvar DefaultCheckSessionIntervalInSeconds = 2;\nvar DefaultSilentRequestTimeoutInSeconds = 10;\nvar UserManagerSettingsStore = class extends OidcClientSettingsStore {\n  constructor(args) {\n    const {\n      popup_redirect_uri = args.redirect_uri,\n      popup_post_logout_redirect_uri = args.post_logout_redirect_uri,\n      popupWindowFeatures = DefaultPopupWindowFeatures,\n      popupWindowTarget = DefaultPopupTarget,\n      redirectMethod = \"assign\",\n      redirectTarget = \"self\",\n      iframeNotifyParentOrigin = args.iframeNotifyParentOrigin,\n      iframeScriptOrigin = args.iframeScriptOrigin,\n      silent_redirect_uri = args.redirect_uri,\n      silentRequestTimeoutInSeconds = DefaultSilentRequestTimeoutInSeconds,\n      automaticSilentRenew = true,\n      validateSubOnSilentRenew = true,\n      includeIdTokenInSilentRenew = false,\n      monitorSession = false,\n      monitorAnonymousSession = false,\n      checkSessionIntervalInSeconds = DefaultCheckSessionIntervalInSeconds,\n      query_status_response_type = \"code\",\n      stopCheckSessionOnError = true,\n      revokeTokenTypes = [\"access_token\", \"refresh_token\"],\n      revokeTokensOnSignout = false,\n      accessTokenExpiringNotificationTimeInSeconds = DefaultAccessTokenExpiringNotificationTimeInSeconds,\n      userStore\n    } = args;\n    super(args);\n    this.popup_redirect_uri = popup_redirect_uri;\n    this.popup_post_logout_redirect_uri = popup_post_logout_redirect_uri;\n    this.popupWindowFeatures = popupWindowFeatures;\n    this.popupWindowTarget = popupWindowTarget;\n    this.redirectMethod = redirectMethod;\n    this.redirectTarget = redirectTarget;\n    this.iframeNotifyParentOrigin = iframeNotifyParentOrigin;\n    this.iframeScriptOrigin = iframeScriptOrigin;\n    this.silent_redirect_uri = silent_redirect_uri;\n    this.silentRequestTimeoutInSeconds = silentRequestTimeoutInSeconds;\n    this.automaticSilentRenew = automaticSilentRenew;\n    this.validateSubOnSilentRenew = validateSubOnSilentRenew;\n    this.includeIdTokenInSilentRenew = includeIdTokenInSilentRenew;\n    this.monitorSession = monitorSession;\n    this.monitorAnonymousSession = monitorAnonymousSession;\n    this.checkSessionIntervalInSeconds = checkSessionIntervalInSeconds;\n    this.stopCheckSessionOnError = stopCheckSessionOnError;\n    this.query_status_response_type = query_status_response_type;\n    this.revokeTokenTypes = revokeTokenTypes;\n    this.revokeTokensOnSignout = revokeTokensOnSignout;\n    this.accessTokenExpiringNotificationTimeInSeconds = accessTokenExpiringNotificationTimeInSeconds;\n    if (userStore) {\n      this.userStore = userStore;\n    } else {\n      const store = typeof window !== \"undefined\" ? window.sessionStorage : new InMemoryWebStorage();\n      this.userStore = new WebStorageStateStore({ store });\n    }\n  }\n};\n\n// src/navigators/IFrameWindow.ts\nvar IFrameWindow = class extends AbstractChildWindow {\n  constructor({\n    silentRequestTimeoutInSeconds = DefaultSilentRequestTimeoutInSeconds\n  }) {\n    super();\n    this._logger = new Logger(\"IFrameWindow\");\n    this._timeoutInSeconds = silentRequestTimeoutInSeconds;\n    this._frame = IFrameWindow.createHiddenIframe();\n    this._window = this._frame.contentWindow;\n  }\n  static createHiddenIframe() {\n    const iframe = window.document.createElement(\"iframe\");\n    iframe.style.visibility = \"hidden\";\n    iframe.style.position = \"fixed\";\n    iframe.style.left = \"-1000px\";\n    iframe.style.top = \"0\";\n    iframe.width = \"0\";\n    iframe.height = \"0\";\n    iframe.setAttribute(\"sandbox\", \"allow-scripts allow-same-origin allow-forms\");\n    window.document.body.appendChild(iframe);\n    return iframe;\n  }\n  async navigate(params) {\n    this._logger.debug(\"navigate: Using timeout of:\", this._timeoutInSeconds);\n    const timer = setTimeout(() => this._abort.raise(new ErrorTimeout(\"IFrame timed out without a response\")), this._timeoutInSeconds * 1e3);\n    this._disposeHandlers.add(() => clearTimeout(timer));\n    return await super.navigate(params);\n  }\n  close() {\n    var _a;\n    if (this._frame) {\n      if (this._frame.parentNode) {\n        this._frame.addEventListener(\"load\", (ev) => {\n          var _a2;\n          const frame = ev.target;\n          (_a2 = frame.parentNode) == null ? void 0 : _a2.removeChild(frame);\n          this._abort.raise(new Error(\"IFrame removed from DOM\"));\n        }, true);\n        (_a = this._frame.contentWindow) == null ? void 0 : _a.location.replace(\"about:blank\");\n      }\n      this._frame = null;\n    }\n    this._window = null;\n  }\n  static notifyParent(url, targetOrigin) {\n    return super._notifyParent(window.parent, url, false, targetOrigin);\n  }\n};\n\n// src/navigators/IFrameNavigator.ts\nvar IFrameNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"IFrameNavigator\");\n  }\n  async prepare({\n    silentRequestTimeoutInSeconds = this._settings.silentRequestTimeoutInSeconds\n  }) {\n    return new IFrameWindow({ silentRequestTimeoutInSeconds });\n  }\n  async callback(url) {\n    this._logger.create(\"callback\");\n    IFrameWindow.notifyParent(url, this._settings.iframeNotifyParentOrigin);\n  }\n};\n\n// src/navigators/PopupWindow.ts\nvar checkForPopupClosedInterval = 500;\nvar PopupWindow = class extends AbstractChildWindow {\n  constructor({\n    popupWindowTarget = DefaultPopupTarget,\n    popupWindowFeatures = {}\n  }) {\n    super();\n    this._logger = new Logger(\"PopupWindow\");\n    const centeredPopup = PopupUtils.center({ ...DefaultPopupWindowFeatures, ...popupWindowFeatures });\n    this._window = window.open(void 0, popupWindowTarget, PopupUtils.serialize(centeredPopup));\n  }\n  async navigate(params) {\n    var _a;\n    (_a = this._window) == null ? void 0 : _a.focus();\n    const popupClosedInterval = setInterval(() => {\n      if (!this._window || this._window.closed) {\n        this._abort.raise(new Error(\"Popup closed by user\"));\n      }\n    }, checkForPopupClosedInterval);\n    this._disposeHandlers.add(() => clearInterval(popupClosedInterval));\n    return await super.navigate(params);\n  }\n  close() {\n    if (this._window) {\n      if (!this._window.closed) {\n        this._window.close();\n        this._abort.raise(new Error(\"Popup closed\"));\n      }\n    }\n    this._window = null;\n  }\n  static notifyOpener(url, keepOpen) {\n    if (!window.opener) {\n      throw new Error(\"No window.opener. Can't complete notification.\");\n    }\n    return super._notifyParent(window.opener, url, keepOpen);\n  }\n};\n\n// src/navigators/PopupNavigator.ts\nvar PopupNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"PopupNavigator\");\n  }\n  async prepare({\n    popupWindowFeatures = this._settings.popupWindowFeatures,\n    popupWindowTarget = this._settings.popupWindowTarget\n  }) {\n    return new PopupWindow({ popupWindowFeatures, popupWindowTarget });\n  }\n  async callback(url, keepOpen = false) {\n    this._logger.create(\"callback\");\n    PopupWindow.notifyOpener(url, keepOpen);\n  }\n};\n\n// src/navigators/RedirectNavigator.ts\nvar RedirectNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"RedirectNavigator\");\n  }\n  async prepare({\n    redirectMethod = this._settings.redirectMethod,\n    redirectTarget = this._settings.redirectTarget\n  }) {\n    var _a;\n    this._logger.create(\"prepare\");\n    let targetWindow = window.self;\n    if (redirectTarget === \"top\") {\n      targetWindow = (_a = window.top) != null ? _a : window.self;\n    }\n    const redirect = targetWindow.location[redirectMethod].bind(targetWindow.location);\n    let abort;\n    return {\n      navigate: async (params) => {\n        this._logger.create(\"navigate\");\n        const promise = new Promise((resolve, reject) => {\n          abort = reject;\n        });\n        redirect(params.url);\n        return await promise;\n      },\n      close: () => {\n        this._logger.create(\"close\");\n        abort == null ? void 0 : abort(new Error(\"Redirect aborted\"));\n        targetWindow.stop();\n      }\n    };\n  }\n};\n\n// src/UserManagerEvents.ts\nvar UserManagerEvents = class extends AccessTokenEvents {\n  constructor(settings) {\n    super({ expiringNotificationTimeInSeconds: settings.accessTokenExpiringNotificationTimeInSeconds });\n    this._logger = new Logger(\"UserManagerEvents\");\n    this._userLoaded = new Event(\"User loaded\");\n    this._userUnloaded = new Event(\"User unloaded\");\n    this._silentRenewError = new Event(\"Silent renew error\");\n    this._userSignedIn = new Event(\"User signed in\");\n    this._userSignedOut = new Event(\"User signed out\");\n    this._userSessionChanged = new Event(\"User session changed\");\n  }\n  load(user, raiseEvent = true) {\n    super.load(user);\n    if (raiseEvent) {\n      this._userLoaded.raise(user);\n    }\n  }\n  unload() {\n    super.unload();\n    this._userUnloaded.raise();\n  }\n  addUserLoaded(cb) {\n    return this._userLoaded.addHandler(cb);\n  }\n  removeUserLoaded(cb) {\n    return this._userLoaded.removeHandler(cb);\n  }\n  addUserUnloaded(cb) {\n    return this._userUnloaded.addHandler(cb);\n  }\n  removeUserUnloaded(cb) {\n    return this._userUnloaded.removeHandler(cb);\n  }\n  addSilentRenewError(cb) {\n    return this._silentRenewError.addHandler(cb);\n  }\n  removeSilentRenewError(cb) {\n    return this._silentRenewError.removeHandler(cb);\n  }\n  _raiseSilentRenewError(e) {\n    this._silentRenewError.raise(e);\n  }\n  addUserSignedIn(cb) {\n    return this._userSignedIn.addHandler(cb);\n  }\n  removeUserSignedIn(cb) {\n    this._userSignedIn.removeHandler(cb);\n  }\n  _raiseUserSignedIn() {\n    this._userSignedIn.raise();\n  }\n  addUserSignedOut(cb) {\n    return this._userSignedOut.addHandler(cb);\n  }\n  removeUserSignedOut(cb) {\n    this._userSignedOut.removeHandler(cb);\n  }\n  _raiseUserSignedOut() {\n    this._userSignedOut.raise();\n  }\n  addUserSessionChanged(cb) {\n    return this._userSessionChanged.addHandler(cb);\n  }\n  removeUserSessionChanged(cb) {\n    this._userSessionChanged.removeHandler(cb);\n  }\n  _raiseUserSessionChanged() {\n    this._userSessionChanged.raise();\n  }\n};\n\n// src/SilentRenewService.ts\nvar SilentRenewService = class {\n  constructor(_userManager) {\n    this._userManager = _userManager;\n    this._logger = new Logger(\"SilentRenewService\");\n    this._isStarted = false;\n    this._retryTimer = new Timer(\"Retry Silent Renew\");\n    this._tokenExpiring = async () => {\n      const logger2 = this._logger.create(\"_tokenExpiring\");\n      try {\n        await this._userManager.signinSilent();\n        logger2.debug(\"silent token renewal successful\");\n      } catch (err) {\n        if (err instanceof ErrorTimeout) {\n          logger2.warn(\"ErrorTimeout from signinSilent:\", err, \"retry in 5s\");\n          this._retryTimer.init(5);\n          return;\n        }\n        logger2.error(\"Error from signinSilent:\", err);\n        this._userManager.events._raiseSilentRenewError(err);\n      }\n    };\n  }\n  async start() {\n    const logger2 = this._logger.create(\"start\");\n    if (!this._isStarted) {\n      this._isStarted = true;\n      this._userManager.events.addAccessTokenExpiring(this._tokenExpiring);\n      this._retryTimer.addHandler(this._tokenExpiring);\n      try {\n        await this._userManager.getUser();\n      } catch (err) {\n        logger2.error(\"getUser error\", err);\n      }\n    }\n  }\n  stop() {\n    if (this._isStarted) {\n      this._retryTimer.cancel();\n      this._retryTimer.removeHandler(this._tokenExpiring);\n      this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring);\n      this._isStarted = false;\n    }\n  }\n};\n\n// src/RefreshState.ts\nvar RefreshState = class {\n  constructor(args) {\n    this.refresh_token = args.refresh_token;\n    this.id_token = args.id_token;\n    this.session_state = args.session_state;\n    this.scope = args.scope;\n    this.data = args.state;\n  }\n};\n\n// src/UserManager.ts\nvar UserManager = class {\n  constructor(settings) {\n    this._logger = new Logger(\"UserManager\");\n    this.settings = new UserManagerSettingsStore(settings);\n    this._client = new OidcClient(settings);\n    this._redirectNavigator = new RedirectNavigator(this.settings);\n    this._popupNavigator = new PopupNavigator(this.settings);\n    this._iframeNavigator = new IFrameNavigator(this.settings);\n    this._events = new UserManagerEvents(this.settings);\n    this._silentRenewService = new SilentRenewService(this);\n    if (this.settings.automaticSilentRenew) {\n      this.startSilentRenew();\n    }\n    this._sessionMonitor = null;\n    if (this.settings.monitorSession) {\n      this._sessionMonitor = new SessionMonitor(this);\n    }\n  }\n  get events() {\n    return this._events;\n  }\n  get metadataService() {\n    return this._client.metadataService;\n  }\n  async getUser() {\n    const logger2 = this._logger.create(\"getUser\");\n    const user = await this._loadUser();\n    if (user) {\n      logger2.info(\"user loaded\");\n      this._events.load(user, false);\n      return user;\n    }\n    logger2.info(\"user not found in storage\");\n    return null;\n  }\n  async removeUser() {\n    const logger2 = this._logger.create(\"removeUser\");\n    await this.storeUser(null);\n    logger2.info(\"user removed from storage\");\n    this._events.unload();\n  }\n  async signinRedirect(args = {}) {\n    this._logger.create(\"signinRedirect\");\n    const {\n      redirectMethod,\n      ...requestArgs\n    } = args;\n    const handle = await this._redirectNavigator.prepare({ redirectMethod });\n    await this._signinStart({\n      request_type: \"si:r\",\n      ...requestArgs\n    }, handle);\n  }\n  async signinRedirectCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signinRedirectCallback\");\n    const user = await this._signinEnd(url);\n    if (user.profile && user.profile.sub) {\n      logger2.info(\"success, signed in subject\", user.profile.sub);\n    } else {\n      logger2.info(\"no subject\");\n    }\n    return user;\n  }\n  async signinPopup(args = {}) {\n    const logger2 = this._logger.create(\"signinPopup\");\n    const {\n      popupWindowFeatures,\n      popupWindowTarget,\n      ...requestArgs\n    } = args;\n    const url = this.settings.popup_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No popup_redirect_uri configured\"));\n    }\n    const handle = await this._popupNavigator.prepare({ popupWindowFeatures, popupWindowTarget });\n    const user = await this._signin({\n      request_type: \"si:p\",\n      redirect_uri: url,\n      display: \"popup\",\n      ...requestArgs\n    }, handle);\n    if (user) {\n      if (user.profile && user.profile.sub) {\n        logger2.info(\"success, signed in subject\", user.profile.sub);\n      } else {\n        logger2.info(\"no subject\");\n      }\n    }\n    return user;\n  }\n  async signinPopupCallback(url = window.location.href, keepOpen = false) {\n    const logger2 = this._logger.create(\"signinPopupCallback\");\n    await this._popupNavigator.callback(url, keepOpen);\n    logger2.info(\"success\");\n  }\n  async signinSilent(args = {}) {\n    var _a;\n    const logger2 = this._logger.create(\"signinSilent\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    let user = await this._loadUser();\n    if (user == null ? void 0 : user.refresh_token) {\n      logger2.debug(\"using refresh token\");\n      const state = new RefreshState(user);\n      return await this._useRefreshToken(state);\n    }\n    const url = this.settings.silent_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n    }\n    let verifySub;\n    if (user && this.settings.validateSubOnSilentRenew) {\n      logger2.debug(\"subject prior to silent renew:\", user.profile.sub);\n      verifySub = user.profile.sub;\n    }\n    const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n    user = await this._signin({\n      request_type: \"si:s\",\n      redirect_uri: url,\n      prompt: \"none\",\n      id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0,\n      ...requestArgs\n    }, handle, verifySub);\n    if (user) {\n      if ((_a = user.profile) == null ? void 0 : _a.sub) {\n        logger2.info(\"success, signed in subject\", user.profile.sub);\n      } else {\n        logger2.info(\"no subject\");\n      }\n    }\n    return user;\n  }\n  async _useRefreshToken(state) {\n    const response = await this._client.useRefreshToken({\n      state,\n      timeoutInSeconds: this.settings.silentRequestTimeoutInSeconds\n    });\n    const user = new User({ ...state, ...response });\n    await this.storeUser(user);\n    this._events.load(user);\n    return user;\n  }\n  async signinSilentCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signinSilentCallback\");\n    await this._iframeNavigator.callback(url);\n    logger2.info(\"success\");\n  }\n  async signinCallback(url = window.location.href) {\n    const { state } = await this._client.readSigninResponseState(url);\n    switch (state.request_type) {\n      case \"si:r\":\n        return await this.signinRedirectCallback(url);\n      case \"si:p\":\n        return await this.signinPopupCallback(url);\n      case \"si:s\":\n        return await this.signinSilentCallback(url);\n      default:\n        throw new Error(\"invalid response_type in state\");\n    }\n  }\n  async signoutCallback(url = window.location.href, keepOpen = false) {\n    const { state } = await this._client.readSignoutResponseState(url);\n    if (!state) {\n      return;\n    }\n    switch (state.request_type) {\n      case \"so:r\":\n        await this.signoutRedirectCallback(url);\n        break;\n      case \"so:p\":\n        await this.signoutPopupCallback(url, keepOpen);\n        break;\n      default:\n        throw new Error(\"invalid response_type in state\");\n    }\n  }\n  async querySessionStatus(args = {}) {\n    const logger2 = this._logger.create(\"querySessionStatus\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    const url = this.settings.silent_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n    }\n    const user = await this._loadUser();\n    const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n    const navResponse = await this._signinStart({\n      request_type: \"si:s\",\n      redirect_uri: url,\n      prompt: \"none\",\n      id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0,\n      response_type: this.settings.query_status_response_type,\n      scope: \"openid\",\n      skipUserInfo: true,\n      ...requestArgs\n    }, handle);\n    try {\n      const signinResponse = await this._client.processSigninResponse(navResponse.url);\n      logger2.debug(\"got signin response\");\n      if (signinResponse.session_state && signinResponse.profile.sub) {\n        logger2.info(\"success for subject\", signinResponse.profile.sub);\n        return {\n          session_state: signinResponse.session_state,\n          sub: signinResponse.profile.sub,\n          sid: signinResponse.profile.sid\n        };\n      }\n      logger2.info(\"success, user not authenticated\");\n      return null;\n    } catch (err) {\n      if (this.settings.monitorAnonymousSession && err instanceof ErrorResponse) {\n        switch (err.error) {\n          case \"login_required\":\n          case \"consent_required\":\n          case \"interaction_required\":\n          case \"account_selection_required\":\n            logger2.info(\"success for anonymous user\");\n            return {\n              session_state: err.session_state\n            };\n        }\n      }\n      throw err;\n    }\n  }\n  async _signin(args, handle, verifySub) {\n    const navResponse = await this._signinStart(args, handle);\n    return await this._signinEnd(navResponse.url, verifySub);\n  }\n  async _signinStart(args, handle) {\n    const logger2 = this._logger.create(\"_signinStart\");\n    try {\n      const signinRequest = await this._client.createSigninRequest(args);\n      logger2.debug(\"got signin request\");\n      return await handle.navigate({\n        url: signinRequest.url,\n        state: signinRequest.state.id,\n        response_mode: signinRequest.state.response_mode,\n        scriptOrigin: this.settings.iframeScriptOrigin\n      });\n    } catch (err) {\n      logger2.debug(\"error after preparing navigator, closing navigator window\");\n      handle.close();\n      throw err;\n    }\n  }\n  async _signinEnd(url, verifySub) {\n    const logger2 = this._logger.create(\"_signinEnd\");\n    const signinResponse = await this._client.processSigninResponse(url);\n    logger2.debug(\"got signin response\");\n    const user = new User(signinResponse);\n    if (verifySub) {\n      if (verifySub !== user.profile.sub) {\n        logger2.debug(\"current user does not match user returned from signin. sub from signin:\", user.profile.sub);\n        throw new ErrorResponse({ ...signinResponse, error: \"login_required\" });\n      }\n      logger2.debug(\"current user matches user returned from signin\");\n    }\n    await this.storeUser(user);\n    logger2.debug(\"user stored\");\n    this._events.load(user);\n    return user;\n  }\n  async signoutRedirect(args = {}) {\n    const logger2 = this._logger.create(\"signoutRedirect\");\n    const {\n      redirectMethod,\n      ...requestArgs\n    } = args;\n    const handle = await this._redirectNavigator.prepare({ redirectMethod });\n    await this._signoutStart({\n      request_type: \"so:r\",\n      post_logout_redirect_uri: this.settings.post_logout_redirect_uri,\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  async signoutRedirectCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signoutRedirectCallback\");\n    const response = await this._signoutEnd(url);\n    logger2.info(\"success\");\n    return response;\n  }\n  async signoutPopup(args = {}) {\n    const logger2 = this._logger.create(\"signoutPopup\");\n    const {\n      popupWindowFeatures,\n      popupWindowTarget,\n      ...requestArgs\n    } = args;\n    const url = this.settings.popup_post_logout_redirect_uri;\n    const handle = await this._popupNavigator.prepare({ popupWindowFeatures, popupWindowTarget });\n    await this._signout({\n      request_type: \"so:p\",\n      post_logout_redirect_uri: url,\n      state: url == null ? void 0 : {},\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  async signoutPopupCallback(url = window.location.href, keepOpen = false) {\n    const logger2 = this._logger.create(\"signoutPopupCallback\");\n    await this._popupNavigator.callback(url, keepOpen);\n    logger2.info(\"success\");\n  }\n  async _signout(args, handle) {\n    const navResponse = await this._signoutStart(args, handle);\n    return await this._signoutEnd(navResponse.url);\n  }\n  async _signoutStart(args = {}, handle) {\n    var _a;\n    const logger2 = this._logger.create(\"_signoutStart\");\n    try {\n      const user = await this._loadUser();\n      logger2.debug(\"loaded current user from storage\");\n      if (this.settings.revokeTokensOnSignout) {\n        await this._revokeInternal(user);\n      }\n      const id_token = args.id_token_hint || user && user.id_token;\n      if (id_token) {\n        logger2.debug(\"setting id_token_hint in signout request\");\n        args.id_token_hint = id_token;\n      }\n      await this.removeUser();\n      logger2.debug(\"user removed, creating signout request\");\n      const signoutRequest = await this._client.createSignoutRequest(args);\n      logger2.debug(\"got signout request\");\n      return await handle.navigate({\n        url: signoutRequest.url,\n        state: (_a = signoutRequest.state) == null ? void 0 : _a.id\n      });\n    } catch (err) {\n      logger2.debug(\"error after preparing navigator, closing navigator window\");\n      handle.close();\n      throw err;\n    }\n  }\n  async _signoutEnd(url) {\n    const logger2 = this._logger.create(\"_signoutEnd\");\n    const signoutResponse = await this._client.processSignoutResponse(url);\n    logger2.debug(\"got signout response\");\n    return signoutResponse;\n  }\n  async revokeTokens(types) {\n    const user = await this._loadUser();\n    await this._revokeInternal(user, types);\n  }\n  async _revokeInternal(user, types = this.settings.revokeTokenTypes) {\n    const logger2 = this._logger.create(\"_revokeInternal\");\n    if (!user)\n      return;\n    const typesPresent = types.filter((type) => typeof user[type] === \"string\");\n    if (!typesPresent.length) {\n      logger2.debug(\"no need to revoke due to no token(s)\");\n      return;\n    }\n    for (const type of typesPresent) {\n      await this._client.revokeToken(\n        user[type],\n        type\n      );\n      logger2.info(`${type} revoked successfully`);\n      if (type !== \"access_token\") {\n        user[type] = null;\n      }\n    }\n    await this.storeUser(user);\n    logger2.debug(\"user stored\");\n    this._events.load(user);\n  }\n  startSilentRenew() {\n    this._logger.create(\"startSilentRenew\");\n    void this._silentRenewService.start();\n  }\n  stopSilentRenew() {\n    this._silentRenewService.stop();\n  }\n  get _userStoreKey() {\n    return `user:${this.settings.authority}:${this.settings.client_id}`;\n  }\n  async _loadUser() {\n    const logger2 = this._logger.create(\"_loadUser\");\n    const storageString = await this.settings.userStore.get(this._userStoreKey);\n    if (storageString) {\n      logger2.debug(\"user storageString loaded\");\n      return User.fromStorageString(storageString);\n    }\n    logger2.debug(\"no user storageString\");\n    return null;\n  }\n  async storeUser(user) {\n    const logger2 = this._logger.create(\"storeUser\");\n    if (user) {\n      logger2.debug(\"storing user\");\n      const storageString = user.toStorageString();\n      await this.settings.userStore.set(this._userStoreKey, storageString);\n    } else {\n      this._logger.debug(\"removing user\");\n      await this.settings.userStore.remove(this._userStoreKey);\n    }\n  }\n  async clearStaleState() {\n    await this._client.clearStaleState();\n  }\n};\n\n// package.json\nvar version = \"2.0.6\";\n\n// src/Version.ts\nvar Version = version;\nexport {\n  AccessTokenEvents,\n  CheckSessionIFrame,\n  ErrorResponse,\n  ErrorTimeout,\n  InMemoryWebStorage,\n  Log,\n  Logger,\n  MetadataService,\n  OidcClient,\n  OidcClientSettingsStore,\n  SessionMonitor,\n  SigninResponse,\n  SigninState,\n  SignoutResponse,\n  State,\n  User,\n  UserManager,\n  UserManagerSettingsStore,\n  Version,\n  WebStorageStateStore\n};\n//# sourceMappingURL=oidc-client-ts.js.map\n","export const mergeScopes = (\r\n    source?: string | string[],\r\n    target?: string | string[]\r\n) => {\r\n    source ||= [];\r\n    target ||= [];\r\n\r\n    if (!Array.isArray(source)) {\r\n        source = source.split(' ');\r\n    }\r\n\r\n    if (!Array.isArray(target)) {\r\n        target = target.split(' ');\r\n    }\r\n\r\n    return source\r\n        .concat(target)\r\n        .filter((value, pos, c) => c.indexOf(value) === pos)\r\n        .join(' ')\r\n        .trim();\r\n};\r\n","import { User, UserManager, UserManagerSettings } from 'oidc-client-ts';\r\nimport { mergeScopes } from './utils';\r\n\r\nexport const AUTH_SANDBOX_PATH = 'https://stage.identity.multicartshop.com';\r\nexport const AUTH_PROD_PATH = 'https://identity.multicartshop.com';\r\nexport const MULTICART_CLIENT_ID = 'Multicart.TypeScript.Client';\r\n\r\nexport interface MulticartOAuthConfigurationParameters {\r\n    client_id?: string;\r\n    redirect_uri?: string;\r\n\r\n    sandbox?: boolean;\r\n    basePath?: string;\r\n    client_secret?: string;\r\n    scopes?: string[];\r\n}\r\n\r\nexport class MulticartOAuthConfiguration {\r\n    constructor(\r\n        private configuration: MulticartOAuthConfigurationParameters = {}\r\n    ) {}\r\n\r\n    set config(configuration: MulticartOAuthConfiguration) {\r\n        this.configuration = configuration;\r\n    }\r\n\r\n    get sandbox(): boolean {\r\n        return !!this.configuration.sandbox;\r\n    }\r\n\r\n    get basePath(): string {\r\n        return this.configuration.basePath || this.sandbox\r\n            ? AUTH_SANDBOX_PATH\r\n            : AUTH_PROD_PATH;\r\n    }\r\n\r\n    get client_id(): string {\r\n        return this.configuration.client_id || MULTICART_CLIENT_ID;\r\n    }\r\n\r\n    get redirect_uri(): string {\r\n        return this.configuration.redirect_uri || this.basePath + '/login';\r\n    }\r\n\r\n    get client_secret(): string | undefined {\r\n        return this.configuration.client_secret;\r\n    }\r\n\r\n    get scopes(): string[] | undefined {\r\n        return this.configuration.scopes;\r\n    }\r\n}\r\n\r\nexport const DefaultMulticartOAuthConfig = new MulticartOAuthConfiguration();\r\n\r\n/**\r\n * Provides a higher level API for signing a user in, signing out, managing the user's claims returned from the OIDC provider,\r\n * and managing an access token returned from the OIDC/OAuth2 provider.\r\n *\r\n * @public\r\n */\r\nexport class MulticartOAuthClient extends UserManager {\r\n    constructor(protected configuration = DefaultMulticartOAuthConfig) {\r\n        const umSettings: UserManagerSettings = {\r\n            authority: configuration.basePath,\r\n            loadUserInfo: true,\r\n            client_id: configuration.client_id,\r\n            redirect_uri: configuration.redirect_uri,\r\n            client_secret: configuration.client_secret,\r\n            scope: mergeScopes(configuration.scopes),\r\n        };\r\n\r\n        super(umSettings);\r\n    }\r\n\r\n    public async signinPasswordGrant({\r\n        username,\r\n        password,\r\n    }: {\r\n        username: string;\r\n        password: string;\r\n    }) {\r\n        const args = {\r\n            extraQueryParams: { username, password, grant_type: 'password' },\r\n        };\r\n\r\n        return this.signinSilent(args);\r\n    }\r\n\r\n    public async signinClientCredentials({\r\n        scopes,\r\n    }: { scopes?: string[] } = {}) {\r\n        const logger = this._logger.create('signinClientCredentials');\r\n        const url = await this.metadataService\r\n            .getTokenEndpoint()\r\n            .catch((reason) => logger.error(reason));\r\n\r\n        if (!url) {\r\n            throw new Error('Token endpoint not be empty');\r\n        }\r\n        const {\r\n            client_id,\r\n            client_secret,\r\n            scope: scopeInternal,\r\n        } = this.settings;\r\n\r\n        const scope = mergeScopes(scopeInternal, scopes);\r\n\r\n        if (!client_secret) {\r\n            throw new Error('No client_secret configured');\r\n        }\r\n\r\n        try {\r\n            const r = await fetch(url, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded',\r\n                },\r\n                body: new URLSearchParams({\r\n                    grant_type: 'client_credentials',\r\n                    client_id,\r\n                    client_secret,\r\n                    scope,\r\n                }).toString(),\r\n                mode: 'cors',\r\n            });\r\n            const resp = await r.json();\r\n\r\n            const user = new User(resp);\r\n            user.expires_at =\r\n                Math.floor(Date.now() / 1000) + (resp.expires_in ?? 0);\r\n\r\n            await this.storeUser(user);\r\n            logger.debug('user stored');\r\n            this._events.load(user);\r\n            return user;\r\n        } catch (e) {\r\n            logger.error(`Login failed`, e);\r\n            throw new Error('Login failed');\r\n        }\r\n    }\r\n}\r\n"],"names":["__viteBrowserExternal","root","factory","module","this","CryptoJS","Math","undefined","crypto","global","require","require$$0","cryptoSecureRandomInt","create","F","obj","subtype","C","C_lib","Base","overrides","instance","properties","propertyName","WordArray","words","sigBytes","encoder","Hex","wordArray","thisWords","thatWords","thisSigBytes","thatSigBytes","i","thatByte","j","clone","nBytes","C_enc","hexChars","bite","hexStr","hexStrLength","Latin1","latin1Chars","latin1Str","latin1StrLength","Utf8","utf8Str","BufferedBlockAlgorithm","data","doFlush","processedWords","dataWords","dataSigBytes","blockSize","blockSizeBytes","nBlocksReady","nWordsReady","nBytesReady","offset","cfg","messageUpdate","hash","hasher","message","key","C_algo","Hasher","H","K","isPrime","n","sqrtN","factor","getFractionalBits","nPrime","W","SHA256","M","a","b","c","e","f","g","h","gamma0x","gamma0","gamma1x","gamma1","ch","maj","sigma0","sigma1","t1","t2","nBitsTotal","nBitsLeft","map","base64Chars","byte1","byte2","byte3","triplet","paddingChar","base64Str","base64StrLength","reverseMap","paddingIndex","parseLoop","bits1","bits2","bitsCombined","r","o","t","nopLogger","level","logger","Log","Log2","reset","setLevel","value","setLogger","Logger","_name","args","err","method","methodLogger","name","staticMethod","staticLogger","prefix","UUID_V4_TEMPLATE","CryptoUtils","code_verifier","hashed","sha256","Base64","client_id","client_secret","basicAuth","Event","cb","idx","ev","JwtUtils","token","jwt_decode","PopupUtils","features","_a","_b","_c","width","Timer","diff","durationInSeconds","logger2","expiration","timerDurationInSeconds","UrlUtils","url","responseMode","params","ErrorResponse","form","ErrorTimeout","AccessTokenEvents","container","duration","expiring","expired","CheckSessionIFrame","_callback","_client_id","_intervalInSeconds","_stopOnError","parsedUrl","resolve","session_state","send","InMemoryWebStorage","index","JsonService","additionalContentTypes","_jwtHandler","input","init","timeoutInSeconds","initFetch","controller","timeoutId","headers","response","contentType","item","json","body","initCredentials","responseText","MetadataService","_settings","metadata","optional","jwks_uri","keySet","WebStorageStateStore","store","keys","DefaultResponseType","DefaultScope","DefaultClientAuthentication","DefaultResponseMode","DefaultStaleStateAgeInSeconds","DefaultClockSkewInSeconds","OidcClientSettingsStore","authority","metadataUrl","signingKeys","metadataSeed","response_type","scope","redirect_uri","post_logout_redirect_uri","client_authentication","prompt","display","max_age","ui_locales","acr_values","resource","response_mode","filterProtocolClaims","loadUserInfo","staleStateAgeInSeconds","clockSkewInSeconds","userInfoJwtIssuer","mergeClaims","stateStore","refreshTokenCredentials","extraQueryParams","extraTokenParams","UserInfoService","_metadataService","payload","claims","TokenClient","grant_type","ProtocolClaims","ResponseValidator","state","hasIdToken","skipUserInfo","validateSub","claims1","claims2","result","claim","values","previousValue","type","tokenResponse","currentToken","profile","current","State","storageString","storage","age","cutoff","remove","SigninState","SigninRequest","state_data","request_type","nonce","optionalParams","OidcScope","SigninResponse","SignoutRequest","id_token_hint","SignoutResponse","OidcClient","settings","request","request_uri","login_hint","signinRequest","signinState","removeState","storedStateString","signoutState","SessionMonitor","_userManager","user","intervalInSeconds","stopOnError","checkSessionIFrame","timerHandle","session","tmpUser","raiseEvent","User","expires_in","messageSource","AbstractChildWindow","keepOpen","reject","listener","origin","reason","dispose","parent","targetOrigin","DefaultPopupWindowFeatures","DefaultPopupTarget","DefaultAccessTokenExpiringNotificationTimeInSeconds","DefaultCheckSessionIntervalInSeconds","DefaultSilentRequestTimeoutInSeconds","UserManagerSettingsStore","popup_redirect_uri","popup_post_logout_redirect_uri","popupWindowFeatures","popupWindowTarget","redirectMethod","redirectTarget","iframeNotifyParentOrigin","iframeScriptOrigin","silent_redirect_uri","silentRequestTimeoutInSeconds","automaticSilentRenew","validateSubOnSilentRenew","includeIdTokenInSilentRenew","monitorSession","monitorAnonymousSession","checkSessionIntervalInSeconds","query_status_response_type","stopCheckSessionOnError","revokeTokenTypes","revokeTokensOnSignout","accessTokenExpiringNotificationTimeInSeconds","userStore","IFrameWindow","iframe","timer","_a2","frame","IFrameNavigator","checkForPopupClosedInterval","PopupWindow","centeredPopup","popupClosedInterval","PopupNavigator","RedirectNavigator","targetWindow","redirect","abort","promise","UserManagerEvents","SilentRenewService","RefreshState","UserManager","requestArgs","handle","verifySub","navResponse","signinResponse","id_token","signoutRequest","signoutResponse","types","typesPresent","version","Version","mergeScopes","source","target","pos","AUTH_SANDBOX_PATH","AUTH_PROD_PATH","MULTICART_CLIENT_ID","MulticartOAuthConfiguration","configuration","DefaultMulticartOAuthConfig","MulticartOAuthClient","umSettings","username","password","scopes","scopeInternal","resp"],"mappings":"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"}